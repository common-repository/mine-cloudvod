(function(){"use strict";var __webpack_modules__={4697:function(e,t,n){var o=n(1526),i=n(6411),r=n(6686),a=n(8160),l=n(211),c=n(2190),s=function(e,t,n){for(var o=0,r=0;o=r,r=(0,i.fj)(),38===o&&12===r&&(t[n]=1),!(0,i.r)(r);)(0,i.lp)();return(0,i.tP)(e,i.FK)},d=new WeakMap,u=function(e){if("rule"===e.type&&e.parent&&!(e.length<1)){for(var t=e.value,n=e.parent,o=e.column===n.column&&e.line===n.line;"rule"!==n.type;)if(!(n=n.parent))return;if((1!==e.props.length||58===t.charCodeAt(0)||d.get(n))&&!o){d.set(e,!0);for(var a=[],l=function(e,t){return(0,i.cE)(function(e,t){var n=-1,o=44;do{switch((0,i.r)(o)){case 0:38===o&&12===(0,i.fj)()&&(t[n]=1),e[n]+=s(i.FK-1,t,n);break;case 2:e[n]+=(0,i.iF)(o);break;case 4:if(44===o){e[++n]=58===(0,i.fj)()?"&\f":"",t[n]=e[n].length;break}default:e[n]+=(0,r.Dp)(o)}}while(o=(0,i.lp)());return e}((0,i.un)(e),t))}(t,a),c=n.props,u=0,p=0;u<l.length;u++)for(var m=0;m<c.length;m++,p++)e.props[p]=a[u]?l[u].replace(/&\f/g,c[m]):c[m]+" "+l[u]}}},p=function(e){if("decl"===e.type){var t=e.value;108===t.charCodeAt(0)&&98===t.charCodeAt(2)&&(e.return="",e.value="")}},m=[a.Ji];t.Z=function(e){var t=e.key;if("css"===t){var n=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(n,(function(e){-1!==e.getAttribute("data-emotion").indexOf(" ")&&(document.head.appendChild(e),e.setAttribute("data-s",""))}))}var i,r,s=e.stylisPlugins||m,d={},v=[];i=e.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+t+' "]'),(function(e){for(var t=e.getAttribute("data-emotion").split(" "),n=1;n<t.length;n++)d[t[n]]=!0;v.push(e)}));var _,f=[u,p],h=[l.P,(0,a.cD)((function(e){_.insert(e)}))],g=(0,a.qR)(f.concat(s,h));r=function(e,t,n,o){var i;_=n,i=e?e+"{"+t.styles+"}":t.styles,(0,l.q)((0,c.MY)(i),g),o&&(w.inserted[t.name]=!0)};var w={key:t,sheet:new o.m({key:t,container:i,nonce:e.nonce,speedy:e.speedy,prepend:e.prepend,insertionPoint:e.insertionPoint}),nonce:e.nonce,inserted:d,registered:{},insert:r};return w.sheet.hydrate(v),w}},6292:function(e,t){t.Z=function(e){for(var t,n=0,o=0,i=e.length;i>=4;++o,i-=4)t=1540483477*(65535&(t=255&e.charCodeAt(o)|(255&e.charCodeAt(++o))<<8|(255&e.charCodeAt(++o))<<16|(255&e.charCodeAt(++o))<<24))+(59797*(t>>>16)<<16),n=1540483477*(65535&(t^=t>>>24))+(59797*(t>>>16)<<16)^1540483477*(65535&n)+(59797*(n>>>16)<<16);switch(i){case 3:n^=(255&e.charCodeAt(o+2))<<16;case 2:n^=(255&e.charCodeAt(o+1))<<8;case 1:n=1540483477*(65535&(n^=255&e.charCodeAt(o)))+(59797*(n>>>16)<<16)}return(((n=1540483477*(65535&(n^=n>>>13))+(59797*(n>>>16)<<16))^n>>>15)>>>0).toString(36)}},5042:function(e,t){t.Z=function(e){var t=Object.create(null);return function(n){return void 0===t[n]&&(t[n]=e(n)),t[n]}}},2443:function(e,t,n){n.d(t,{E:function(){return _},c:function(){return m},h:function(){return c}});var o=n(9196),i=n(4697),r=n(444),a=n(302),l=n(7278),c={}.hasOwnProperty,s=(0,o.createContext)("undefined"!=typeof HTMLElement?(0,i.Z)({key:"css"}):null);s.Provider;var d=function(e){return(0,o.forwardRef)((function(t,n){var i=(0,o.useContext)(s);return e(t,i,n)}))},u=(0,o.createContext)({}),p="__EMOTION_TYPE_PLEASE_DO_NOT_USE__",m=function(e,t){var n={};for(var o in t)c.call(t,o)&&(n[o]=t[o]);return n[p]=e,n},v=function(e){var t=e.cache,n=e.serialized,o=e.isStringTag;return(0,r.hC)(t,n,o),(0,l.L)((function(){return(0,r.My)(t,n,o)})),null},_=d((function(e,t,n){var i=e.css;"string"==typeof i&&void 0!==t.registered[i]&&(i=t.registered[i]);var l=e[p],s=[i],d="";"string"==typeof e.className?d=(0,r.fp)(t.registered,s,e.className):null!=e.className&&(d=e.className+" ");var m=(0,a.O)(s,void 0,(0,o.useContext)(u));d+=t.key+"-"+m.name;var _={};for(var f in e)c.call(e,f)&&"css"!==f&&f!==p&&(_[f]=e[f]);return _.ref=n,_.className=d,(0,o.createElement)(o.Fragment,null,(0,o.createElement)(v,{cache:t,serialized:m,isStringTag:"string"==typeof l}),(0,o.createElement)(l,_))}))},917:function(e,t,n){n.d(t,{iv:function(){return l},tZ:function(){return a}});var o=n(9196),i=(n(4697),n(2443)),r=(n(8679),n(302)),a=(n(7278),function(e,t){var n=arguments;if(null==t||!i.h.call(t,"css"))return o.createElement.apply(void 0,n);var r=n.length,a=new Array(r);a[0]=i.E,a[1]=(0,i.c)(e,t);for(var l=2;l<r;l++)a[l]=n[l];return o.createElement.apply(null,a)});function l(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return(0,r.O)(t)}},302:function(e,t,n){n.d(t,{O:function(){return _}});var o=n(6292),i=n(4371),r=n(5042),a=/[A-Z]|^ms/g,l=/_EMO_([^_]+?)_([^]*?)_EMO_/g,c=function(e){return 45===e.charCodeAt(1)},s=function(e){return null!=e&&"boolean"!=typeof e},d=(0,r.Z)((function(e){return c(e)?e:e.replace(a,"-$&").toLowerCase()})),u=function(e,t){switch(e){case"animation":case"animationName":if("string"==typeof t)return t.replace(l,(function(e,t,n){return m={name:t,styles:n,next:m},t}))}return 1===i.Z[e]||c(e)||"number"!=typeof t||0===t?t:t+"px"};function p(e,t,n){if(null==n)return"";if(void 0!==n.__emotion_styles)return n;switch(typeof n){case"boolean":return"";case"object":if(1===n.anim)return m={name:n.name,styles:n.styles,next:m},n.name;if(void 0!==n.styles){var o=n.next;if(void 0!==o)for(;void 0!==o;)m={name:o.name,styles:o.styles,next:m},o=o.next;return n.styles+";"}return function(e,t,n){var o="";if(Array.isArray(n))for(var i=0;i<n.length;i++)o+=p(e,t,n[i])+";";else for(var r in n){var a=n[r];if("object"!=typeof a)null!=t&&void 0!==t[a]?o+=r+"{"+t[a]+"}":s(a)&&(o+=d(r)+":"+u(r,a)+";");else if(!Array.isArray(a)||"string"!=typeof a[0]||null!=t&&void 0!==t[a[0]]){var l=p(e,t,a);switch(r){case"animation":case"animationName":o+=d(r)+":"+l+";";break;default:o+=r+"{"+l+"}"}}else for(var c=0;c<a.length;c++)s(a[c])&&(o+=d(r)+":"+u(r,a[c])+";")}return o}(e,t,n);case"function":if(void 0!==e){var i=m,r=n(e);return m=i,p(e,t,r)}}if(null==t)return n;var a=t[n];return void 0!==a?a:n}var m,v=/label:\s*([^\s;\n{]+)\s*(;|$)/g,_=function(e,t,n){if(1===e.length&&"object"==typeof e[0]&&null!==e[0]&&void 0!==e[0].styles)return e[0];var i=!0,r="";m=void 0;var a=e[0];null==a||void 0===a.raw?(i=!1,r+=p(n,t,a)):r+=a[0];for(var l=1;l<e.length;l++)r+=p(n,t,e[l]),i&&(r+=a[l]);v.lastIndex=0;for(var c,s="";null!==(c=v.exec(r));)s+="-"+c[1];return{name:(0,o.Z)(r)+s,styles:r,next:m}}},1526:function(e,t,n){n.d(t,{m:function(){return o}});var o=function(){function e(e){var t=this;this._insertTag=function(e){var n;n=0===t.tags.length?t.insertionPoint?t.insertionPoint.nextSibling:t.prepend?t.container.firstChild:t.before:t.tags[t.tags.length-1].nextSibling,t.container.insertBefore(e,n),t.tags.push(e)},this.isSpeedy=void 0===e.speedy||e.speedy,this.tags=[],this.ctr=0,this.nonce=e.nonce,this.key=e.key,this.container=e.container,this.prepend=e.prepend,this.insertionPoint=e.insertionPoint,this.before=null}var t=e.prototype;return t.hydrate=function(e){e.forEach(this._insertTag)},t.insert=function(e){this.ctr%(this.isSpeedy?65e3:1)==0&&this._insertTag(function(e){var t=document.createElement("style");return t.setAttribute("data-emotion",e.key),void 0!==e.nonce&&t.setAttribute("nonce",e.nonce),t.appendChild(document.createTextNode("")),t.setAttribute("data-s",""),t}(this));var t=this.tags[this.tags.length-1];if(this.isSpeedy){var n=function(e){if(e.sheet)return e.sheet;for(var t=0;t<document.styleSheets.length;t++)if(document.styleSheets[t].ownerNode===e)return document.styleSheets[t]}(t);try{n.insertRule(e,n.cssRules.length)}catch(e){}}else t.appendChild(document.createTextNode(e));this.ctr++},t.flush=function(){this.tags.forEach((function(e){return e.parentNode&&e.parentNode.removeChild(e)})),this.tags=[],this.ctr=0},e}()},4371:function(e,t){t.Z={animationIterationCount:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1}},7278:function(e,t,n){n.d(t,{L:function(){return r}});var o=n(9196),i=!!o.useInsertionEffect&&o.useInsertionEffect,r=i||function(e){return e()};i||o.useLayoutEffect},444:function(e,t,n){function o(e,t,n){var o="";return n.split(" ").forEach((function(n){void 0!==e[n]?t.push(e[n]+";"):o+=n+" "})),o}n.d(t,{My:function(){return r},fp:function(){return o},hC:function(){return i}});var i=function(e,t,n){var o=e.key+"-"+t.name;!1===n&&void 0===e.registered[o]&&(e.registered[o]=t.styles)},r=function(e,t,n){i(e,t,n);var o=e.key+"-"+t.name;if(void 0===e.inserted[t.name]){var r=t;do{e.insert(t===r?"."+o:"",r,e.sheet,!0),r=r.next}while(void 0!==r)}}},4712:function(e,t,n){n(9307);var o=n(917);const{Flex:i,FlexBlock:r,Spinner:a}=wp.components;t.Z=e=>{let{className:t}=e;return(0,o.tZ)(i,{className:t},(0,o.tZ)(r,{css:{textAlign:"center"}},(0,o.tZ)(a,null)))}},9866:function(e,t,n){n(9307);var o=n(917);const{Modal:i}=wp.components;t.Z=e=>{let{onClose:t,title:n,header:r,error:a,mainContent:l,sidebar:c,footer:s}=e;return(0,o.tZ)(i,{title:n||wp.i18n.__("Add Media","mine-cloudvod"),onRequestClose:t,shouldCloseOnClickOutside:!1,css:o.iv`
        width: 100%;
        height: 100%;
        max-width: calc(100% - 32px);
        max-height: calc(100% - 32px);

        .components-modal__content {
          display: flex;
          flex-direction: column;
        }
      `,overlayClassName:"mine-cloudvod__modal-overlay"},(0,o.tZ)("div",{css:o.iv`
          @media screen and (min-width: 780px) {
            margin: 0 -24px -24px;
            display: grid;
            flex: 1;
            max-height: calc(100vh - 116px);
            height: calc(100vh - 116px);
            grid-template-columns: 1fr 1fr minmax(0px, 267px);
            grid-template-rows: minmax(50px, auto) 1fr 60px;
            grid-template-areas:
              "header header sidebar"
              "main main sidebar"
              "footer footer footer";
            overflow: hidden;
          }
        `,"data-cy":"media-modal"},(0,o.tZ)("div",{css:o.iv`
            grid-area: header;
            padding: 24px 24px 12px 24px;
          `},(0,o.tZ)("div",{css:o.iv`
              display: flex;
              align-items: center;

              > * {
                margin-right: 10px;
              }
            `},r),a),(0,o.tZ)("div",{css:o.iv`
            grid-area: main;
            display: grid;
            overflow: hidden;

            .components-drop-zone__provider {
              overflow: hidden;
              display: grid;
            }

            .components-drop-zone {
              z-index: 99;
            }
          `},l),(0,o.tZ)("div",{css:o.iv`
            display: none;
            grid-area: sidebar;
            padding: 0 16px;
            z-index: 75;
            background: #f3f3f3;
            border-left: 1px solid #ddd;
            overflow: auto;

            @media screen and (min-width: 780px) {
              display: block;
            }

            .sidebar-content {
              padding: 16px 0;
            }
          `},c),(0,o.tZ)("div",{css:o.iv`
            grid-area: footer;
            border-top: 1px solid #ddd;
            display: flex;
            align-items: center;
            justify-content: flex-end;
            padding: 8px;
          `},s)))}},3572:function(__unused_webpack_module,__webpack_exports__,__webpack_require__){var _wordpress_element__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(9307),_wordpress_element__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_wordpress_element__WEBPACK_IMPORTED_MODULE_0__),_emotion_react__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(917),_share_post_upload__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(2736),_share_store_store__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(4396),_OssSidebar__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(8386),_video_OssVideos__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(278),_OssHeader__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(3657),_OssFooter__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(450),_upload_OssUploads__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(7389),_MediaPopupTemplate__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(9866);const{Button:Button,DropZone:DropZone,Notice:Notice}=wp.components,{useState:useState,useEffect:useEffect,Fragment:Fragment}=wp.element,{dispatch:dispatch,useSelect:useSelect}=wp.data;__webpack_exports__.Z=_ref=>{let{onClose:onClose,onChoose:onChoose,noticeOperations:noticeOperations}=_ref;function onChooseOss(e){e.videoId=e.key,onChoose(e)}const[error,setError]=useState(""),[progress,setProgress]=useState(0),curBucket=useSelect((e=>e("mine-cloudvod/vod").ui("curBucket"))),uploads=useSelect((e=>e("mine-cloudvod/vod").uploads())),errors=useSelect((e=>e("mine-cloudvod/vod").errors()));useEffect((()=>{dispatch("mine-cloudvod/vod").setVideosFetched(!1),dispatch("mine-cloudvod/vod").setVideos([]),dispatch("mine-cloudvod/vod").setBucketsFetched(!1),dispatch("mine-cloudvod/vod").setBuckets([])}),[]);const buckets=useSelect((e=>e("mine-cloudvod/vod").buckets())),bucketsFetched=useSelect((e=>e("mine-cloudvod/vod").bucketsFetched()));useEffect((()=>{bucketsFetched||bucketsfetch()}),[bucketsFetched]);const bucketsfetch=async function(){let{sync:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{sync:!1};try{const e=await wp.apiFetch({path:wp.url.addQueryArgs("mine-cloudvod/v1/aliyun/oss/buckets")});dispatch("mine-cloudvod/vod").setBuckets(e)}catch(t){e||dispatch("mine-cloudvod/vod").addError(t.message)}finally{dispatch("mine-cloudvod/vod").setBucketsFetched(!0)}},uploadFile=async files=>{dispatch("mine-cloudvod/vod").addUploads(files);var xmlhttp=null;window.XMLHttpRequest?xmlhttp=new XMLHttpRequest:window.ActiveXObject&&(xmlhttp=new ActiveXObject("Microsoft.XMLHTTP"));var formData=[],path="";if(null!=xmlhttp){var serverUrl=wp.url.addQueryArgs(mcv_nonce.restRootUrl+"mine-cloudvod/v1/aliyun/oss/uploadauth",{bucket:curBucket});xmlhttp.open("GET",serverUrl,!1),xmlhttp.send(null);var postData=xmlhttp.responseText;postData=eval("("+postData+")"),path=postData.host,formData.push({name:"key",value:postData.dir+files[0].name}),formData.push({name:"policy",value:postData.policy}),formData.push({name:"OSSAccessKeyId",value:postData.accessid}),formData.push({name:"success_action_status",value:"200"}),formData.push({name:"Signature",value:postData.signature})}(0,_share_post_upload__WEBPACK_IMPORTED_MODULE_8__.Z)({file:files[0],path:path,onProgress:e=>{setProgress(e)},onComplete:e=>{dispatch("mine-cloudvod/vod").removeUpload(e),dispatch("mine-cloudvod/vod").setVideosFetched(!1)},onError:e=>{dispatch("mine-cloudvod/vod").addError(e.message)},formData:formData})},onCloseConfirm=()=>{uploads.length?confirm("Discard your uploads?")&&(onClose(),dispatch("mine-cloudvod/vod").setUploads([])):onClose()},title=wp.i18n.__("Select or Upload Aliyun OSS Video","mine-cloudvod"),mainContent=()=>(0,_emotion_react__WEBPACK_IMPORTED_MODULE_9__.tZ)("div",{css:_emotion_react__WEBPACK_IMPORTED_MODULE_9__.iv`
          overflow: auto;
          display: flex;
          flex-direction: column;
        `},(0,_emotion_react__WEBPACK_IMPORTED_MODULE_9__.tZ)("div",{css:_emotion_react__WEBPACK_IMPORTED_MODULE_9__.iv`
            padding: 12px 24px;
            overflow: auto;
            display: flex;
            flex-direction: column;
          `},!!errors.length&&errors.map((e=>(0,_emotion_react__WEBPACK_IMPORTED_MODULE_9__.tZ)(Notice,{key:e,css:_emotion_react__WEBPACK_IMPORTED_MODULE_9__.iv`
                    margin: 0 0 20px 0;
                  `,status:"error",onRemove:()=>dispatch("mine-cloudvod/vod").removeError(e)},e))),(0,_emotion_react__WEBPACK_IMPORTED_MODULE_9__.tZ)("div",{css:_emotion_react__WEBPACK_IMPORTED_MODULE_9__.iv`
              display: flex;
              align-items: stretch;
            `},(0,_emotion_react__WEBPACK_IMPORTED_MODULE_9__.tZ)(_video_OssVideos__WEBPACK_IMPORTED_MODULE_3__.Z,{bucketsFetched:bucketsFetched,curBucket:curBucket})),(0,_emotion_react__WEBPACK_IMPORTED_MODULE_9__.tZ)(DropZone,{label:"Drop files",onFilesDrop:uploadFile}))),header=(0,_emotion_react__WEBPACK_IMPORTED_MODULE_9__.tZ)(_OssHeader__WEBPACK_IMPORTED_MODULE_4__.Z,{onUpload:uploadFile,buckets:buckets,afterUpload:(0,_emotion_react__WEBPACK_IMPORTED_MODULE_9__.tZ)(_upload_OssUploads__WEBPACK_IMPORTED_MODULE_6__.Z,{uploads:uploads,error:error,progress:progress})}),sidebar=(0,_emotion_react__WEBPACK_IMPORTED_MODULE_9__.tZ)(_OssSidebar__WEBPACK_IMPORTED_MODULE_2__.Z,null),footer=(0,_emotion_react__WEBPACK_IMPORTED_MODULE_9__.tZ)(_OssFooter__WEBPACK_IMPORTED_MODULE_5__.Z,{onChoose:onChooseOss});return(0,_emotion_react__WEBPACK_IMPORTED_MODULE_9__.tZ)(_MediaPopupTemplate__WEBPACK_IMPORTED_MODULE_7__.Z,{title:title,header:header,mainContent:mainContent(),onClose:onCloseConfirm,footer:footer,sidebar:sidebar})}},450:function(e,t,n){var o=n(9307);const{Button:i}=wp.components,{useState:r,useEffect:a}=wp.element,{useSelect:l}=wp.data;t.Z=e=>{let{onChoose:t}=e;const[n,c]=r(null),[s,d]=r(!1),u=l((e=>e("mine-cloudvod/vod").ui("selectedId"))),p=l((e=>e("mine-cloudvod/vod").ui("ossVideos")));return a((()=>{p&&c(u?p.find((e=>e.videoId===u)):null)}),[p,u]),a((()=>{n&&"Normal"==n.status?d(!0):d(n&&"Normal"==n.status)}),[n]),(0,o.createElement)(i,{isPrimary:!0,disabled:!s,onClick:()=>t(n)},s?wp.i18n.__("Choose","mine-cloudvod"):wp.i18n.__("Please Choose...","mine-cloudvod"))}},3657:function(e,t,n){n(9307);var o=n(917);const{Flex:i,FlexBlock:r,FlexItem:a,SelectControl:l,FormFileUpload:c}=wp.components,{dispatch:s,useSelect:d}=wp.data,{useState:u,useEffect:p,Fragment:m}=wp.element;t.Z=e=>{let{onUpload:t,afterUpload:n,buckets:m}=e;const v=d((e=>e("mine-cloudvod/vod").ui("curBucket"))),[_,f]=u(!1),[h,g]=u([{label:wp.i18n.__("-- Select a bucket, please --","mine-cloudvod"),value:""}]);return p((()=>{let e=m.map((e=>(1==e[1]&&s("mine-cloudvod/vod").setUI("curBucket",e[0]),{label:e[0],value:e[0]})));e.unshift({label:wp.i18n.__("-- Select a bucket, please --","mine-cloudvod"),value:""}),g(e)}),[m]),p((()=>{!1===_&&v&&f(v)}),[v]),(0,o.tZ)(i,null,(0,o.tZ)(r,null,(0,o.tZ)(i,{justify:"flex-start"},(0,o.tZ)(c,{multiple:!1,isPrimary:!0,accept:"video/mp4,video/x-m4v,video/*",onChange:e=>{e.target.files&&(t(e.target.files),jQuery(e.target).val(null))}},wp.i18n.__("Upload Videos","mine-cloudvod")),n)),(0,o.tZ)(a,null,(0,o.tZ)(i,null,(0,o.tZ)("div",{className:"mcv-select-bucket"},(0,o.tZ)(l,{value:_,options:h,onChange:e=>{""!=e&&(s("mine-cloudvod/vod").setUI("curBucket",e),s("mine-cloudvod/vod").setVideosFetched(!1)),f(e)}})))))}},8386:function(e,t,n){n(9307);var o=n(1101),i=n(917);const{Button:r,BaseControl:a,Disabled:l,Card:c,CardBody:s}=wp.components,{useState:d,useContext:u,useEffect:p}=wp.element,{dispatch:m,useSelect:v}=wp.data;t.Z=()=>{const[e,t]=d(!1),[n,u]=d(!1),[_,f]=d(null),h=v((e=>e("mine-cloudvod/vod").ui("selectedId"))),g=v((e=>e("mine-cloudvod/vod").ui("ossVideos")));p((()=>{g&&f(h?g.find((e=>e.videoId===h)):null)}),[g,h]);const w=i.iv`
    margin-top: 5px;
  `;if(!_)return"";const y=e=>e.coverURL;return _&&(0,i.tZ)("div",{className:"mine-cloudvod__media-modal-sidebar-content"},(0,i.tZ)(a,{css:i.iv`
            position: relative;
          `},(0,i.tZ)(l,{key:_.videoId},(0,o.P$)(_)&&y(_)&&(0,i.tZ)("img",{src:y(_),css:{maxWidth:"100%"}})),(0,i.tZ)(r,{isSmall:!0,isPrimary:!0,isBusy:!(0,o.P$)(_),css:i.iv`
              ${(0,o.P$)(_)?"position: absolute;":""}
              top: 8px;
              right: 8px;
              font-size: 11px;
              color: #ffffff;
              padding: 2px 10px;
              border-radius: 9999px;
            `},(0,o.li)(_))),(0,i.tZ)(a,null,(0,i.tZ)(a.VisualLabel,null,wp.i18n.__("Name","mine-cloudvod")),(0,i.tZ)("h3",{css:w},_.title)),(0,i.tZ)(a,null,(0,i.tZ)(a.VisualLabel,null,wp.i18n.__("Size","mine-cloudvod")),(0,i.tZ)("h3",{css:w},(0,o.RD)(_.size||0))),(0,i.tZ)(a,null,(0,i.tZ)(a.VisualLabel,null,wp.i18n.__("Storage Class","mine-cloudvod")),(0,i.tZ)("h3",{css:w},_.storageClass)),(0,i.tZ)(a,null,(0,i.tZ)(a.VisualLabel,null,wp.i18n.__("Created","mine-cloudvod")),(0,i.tZ)("h3",{css:w},(0,o.FK)(_.creationTime))),(0,i.tZ)(a,null,e?(0,i.tZ)(c,null,(0,i.tZ)(s,null,(0,i.tZ)("p",null,(0,i.tZ)("strong",null,wp.i18n.__("Are you sure?","mine-cloudvod"))),(0,i.tZ)("p",null,wp.i18n.__("Are you sure you want to delete this video?","mine-cloudvod")),(0,i.tZ)(r,{isDestructive:!0,disabled:n,isBusy:n,onClick:e=>{e.preventDefault(),(async()=>{await wp.apiFetch({path:"mine-cloudvod/v1/aliyun/oss/delvideo",method:"DELETE",data:{object:_.key,bucket:_.bucket}});let e=g.filter((e=>e.videoId!==_.videoId));m("mine-cloudvod/vod").setUI("ossVideos",e),m("mine-cloudvod/vod").setUI("selectedId",null),u(!1),t(!1)})(),u(!0)}},wp.i18n.__("Yes","mine-cloudvod")),(0,i.tZ)(r,{onClick:()=>t(!1)},wp.i18n.__("Cancel","mine-cloudvod")))):(0,i.tZ)(r,{isDestructive:!0,onClick:()=>{t(!e)}},wp.i18n.__("Delete video","mine-cloudvod"))))}},5174:function(e,t,n){n(9307);var o=n(917);t.Z=e=>{let{id:t,className:n,progress:i}=e;return(0,o.tZ)("div",{className:n},(0,o.tZ)("div",{id:`mcv_progress_${t}`,css:o.iv`
          height: 100%;
          background-color: var(--wp-admin-theme-color, #007cba);
        `,style:{width:`${i}%`}}))}},7389:function(e,t,n){n(9307);var o=n(917),i=n(5174);const{useEffect:r,useRef:a,useMemo:l,useState:c}=wp.element,{dispatch:s,useSelect:d}=wp.data;t.Z=e=>{let{uploads:t,error:n,progress:r}=e;return t.length?(0,o.tZ)("div",{css:o.iv`
        overflow: auto;
        display: flex;
        align-items: center;
        position: relative;
      `},t.length&&t.map((e=>(0,o.tZ)("div",{key:e.name,css:o.iv`
                display: flex;
                align-items: center;
                justify-content: space-between;
                animation: components-button__busy-animation 2500ms infinite linear;
                opacity: 1;
                padding: 6px 12px;
                border-radius: 99999px;
                border: 1px solid #dddddd;
                background-size: 100px 100%;
                background-image: linear-gradient(
                  -45deg,
                  #ffffff 33%,
                  #f3f3f3 33%,
                  #f3f3f3 70%,
                  #ffffff 70%
                );
              `},(0,o.tZ)("div",{css:o.iv`
                  flex: 1;
                  white-space: nowrap;
                  overflow: hidden;
                  max-width: 150px;
                  text-overflow: ellipsis;
                  font-weight: bold;
                `},!!n&&n,e.name,"..."),(0,o.tZ)("div",{css:o.iv`
                  display: flex;
                  align-items: center;
                `},(0,o.tZ)(i.Z,{css:o.iv`
                    width: 100px;
                    height: 3px;
                    margin: 0 5px;
                    background: #e3e3e3;
                    border-radius: 9999px;
                    overflow: hidden;
                  `,progress:r})))))):""}},278:function(e,t,n){n.d(t,{Z:function(){return b}}),n(9307);var o=n(917),i=n(1101);const{Icon:r,Button:a}=wp.components,{useEffect:l,useState:c}=wp.element,{useSelect:s,dispatch:d}=wp.data;var u=e=>{let{video:t,onClick:n,isSelected:r}=e;const[a,d]=c(),u=s((e=>e("mine-cloudvod/vod").ui("selectedId")));l((()=>{d(u?u===t.key:null)}),[u]);const p=r?"is-selected":"";return(0,o.tZ)("div",{key:t.key,className:`mcv-media-list-item ${p}`,onClick:n},(0,o.tZ)("div",{className:"mine-cloudvod__media-list-item-icon"},(0,o.tZ)("svg",{className:"mcv-block-icon",width:"28px",height:"28px",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg",fill:"none"},(0,o.tZ)("path",{d:"M917.792 229.088c-22.208-30.304-53.184-65.696-87.168-99.712s-69.408-64.96-99.712-87.168C679.328 4.384 654.304 0 640 0H144A80.096 80.096 0 0 0 64 80v864C64 988.096 99.872 1024 144 1024h736c44.096 0 80-35.904 80-80V320c0-14.336-4.384-39.36-42.208-90.912z m-132.416-54.464A874.688 874.688 0 0 1 857.952 256H704V102.048a874.688 874.688 0 0 1 81.376 72.576zM896 944c0 8.672-7.328 16-16 16h-736a16.224 16.224 0 0 1-16-16v-864c0-8.672 7.328-16 16-16H640v224a32 32 0 0 0 32 32h224v624zM256 512h320v320H256V512zM576 640l192-128v320l-192-128z"}))),(0,o.tZ)("div",{className:"mine-cloudvod__media-list-item-title"},t.key),(0,o.tZ)("div",{className:"mine-cloudvod__media-list-item-size"},(0,i.RD)(t.size)),(0,o.tZ)("div",{className:"mine-cloudvod__media-list-item-modified"},(0,i.FK)(t.lastModified)))},p=n(4712);const{useState:m,useEffect:v,Fragment:_}=wp.element,{Flex:f,FormFileUpload:h,Notice:g}=wp.components,{dispatch:w,useSelect:y}=wp.data;var b=e=>{let{bucketsFetched:t,curBucket:n}=e;const[i,r]=m(!1),[a,l]=m(""),c=y((e=>e("mine-cloudvod/vod").videosFetched())),s=y((e=>e("mine-cloudvod/vod").ui("ossVideos"))),d=y((e=>e("mine-cloudvod/vod").uploads()));v((()=>{!c&&n&&b()}),[c,n]);const b=async function(){let{sync:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{sync:!1};if(n)try{const e=await wp.apiFetch({path:wp.url.addQueryArgs("mine-cloudvod/v1/aliyun/oss/videos",{bucket:n})});w("mine-cloudvod/vod").setUI("ossVideos",e.items),l("")}catch(t){e||w("mine-cloudvod/vod").addError(t.message)}finally{w("mine-cloudvod/vod").setVideosFetched(!0)}};return a?(0,o.tZ)(g,{status:"warning",isDismissible:!1},(0,o.tZ)("div",{css:{display:"flex",alignItems:"center"}},(0,o.tZ)(p.Z,{css:{flex:1}}),a)):c?(0,o.tZ)(_,null,s&&s.length?(0,o.tZ)("div",{key:"mcv-alioss-videos"},(0,o.tZ)("h2",null,wp.i18n.__("Videos","mine-cloudvod")),s.map((e=>(0,o.tZ)(u,{key:e.key,video:e,onClick:()=>{e.videoId=e.key,e.title=e.key,e.status=e.type,e.creationTime=e.lastModified,w("mine-cloudvod/vod").setUI("selectedId",e.videoId),r(e)},isSelected:i.key===e.key})))):(0,o.tZ)(f,{align:"center",justify:"center",css:o.iv`
          height: 100%;
          text-align: center;
        `},(0,o.tZ)("div",null,(0,o.tZ)("h2",null,wp.i18n.__("Drop video files here to upload","mine-cloudvod")),(0,o.tZ)("p",null,wp.i18n.__("or browse for a video","mine-cloudvod")),(0,o.tZ)(h,{isSecondary:!0,accept:"video/mp4,video/x-m4v,video/*",onChange:e=>{if(e.target.files){for(var t=0;t<e.target.files.length;t++)e.target.files[t].id=t+d.length;w("mine-cloudvod/vod").addUploads(e.target.files),jQuery(e.target).val(null)}}},wp.i18n.__("Upload New Video","mine-cloudvod"))))):(0,o.tZ)(p.Z,{css:{flex:1}})}},2736:function(e,t,n){function o(e){let t,n,{file:o,path:i,formData:r,onProgress:a,onComplete:l,onError:c,headers:s,method:d}=e,u=new XMLHttpRequest;var p;d||(d="POST"),"POST"==d?(p=new FormData,r&&r.map((e=>{p.append(e.name,e.value)})),r&&p.append("file",o)):"PUT"==d&&(p=o),u.open(d,i,!0),s&&Object.keys(s).forEach((e=>{u.setRequestHeader(e,s[e])})),u.onreadystatechange=function(){4==u.readyState&&200==u.status&&(console.log("uploaded"),l(o))},u.upload.onloadstart=function(){console.log("Start to upload"),t=(new Date).getTime(),n=0},u.upload.onprogress=function(e){console.log("Uploading......");let o=(e.loaded/e.total*100).toFixed(0);a(o);let i=((new Date).getTime()-t)/1e3,r=(e.loaded-n)/i;t=(new Date).getTime(),n=e.loaded;let l="b/s";r/1024>1&&(l="kb/s",r/=1024),r/1024>1&&(l="mb/s",r/=1024),console.log(r.toFixed(2)+l)},u.upload.onload=function(){},u.upload.onerror=function(e){c(e)},u.send(p)}n.d(t,{Z:function(){return o}})},4839:function(e,t,n){function o(e){return{type:"SET_VIDEOS",value:e}}function i(e){return{type:"SET_BUCKETS",value:e}}function r(e){return{type:"ADD_VIDEOS",value:e}}function a(e){return{type:"REMOVE_VIDEO",value:e}}function l(e){return{type:"SET_UPLOADS",value:e}}function c(e){return{type:"ADD_UPLOADS",value:e}}function s(e){return{type:"REMOVE_UPLOAD",value:e}}function d(e){return{type:"SET_VIDEOS_FETCHED",value:e}}function u(e){return{type:"SET_BUCKETS_FETCHED",value:e}}function p(e){return{type:"SET_LOADING",value:e}}function m(e,t){return{type:"SET_UI_ITEM",item:e,value:t}}function v(e){return{type:"ADD_ERROR",value:e}}function _(e){return{type:"REMOVE_ERROR",value:e}}n.r(t),n.d(t,{addError:function(){return v},addUploads:function(){return c},addVideos:function(){return r},removeError:function(){return _},removeUpload:function(){return s},removeVideo:function(){return a},setBuckets:function(){return i},setBucketsFetched:function(){return u},setLoading:function(){return p},setUI:function(){return m},setUploads:function(){return l},setVideos:function(){return o},setVideosFetched:function(){return d}})},1090:function(e,t){const{combineReducers:n}=wp.data;t.Z=n({videosReducer:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_VIDEOS":return t.value;case"ADD_VIDEOS":return[...e,...t.value];case"ADD_VIDEO":return[...e,t.value];case"REMOVE_VIDEO":return e.filter((e=>e.videoId!==t.value.videoId))}return e},uploadsReducer:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_UPLOADS":return t.value;case"ADD_UPLOADS":return[...e,...t.value];case"ADD_UPLOAD":return[...e,t.value];case"UPDATE_UPLOAD":return e.map(((e,n)=>e.id!==t.value.id?e:{...e,...t.value}));case"REMOVE_UPLOAD":return e.filter((e=>e!==t.value))}return e},UIReducer:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{loading:!1,videosFetched:!1,bucketsFetched:!1,createCollection:!1,selectedId:null},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_LOADING":return{...e,loading:t.value};case"SET_VIDEOS_FETCHED":return{...e,videosFetched:t.value};case"SET_BUCKETS_FETCHED":return{...e,bucketsFetched:t.value};case"SET_UI_ITEM":return{...e,[t.item]:t.value}}return e},errorReducer:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"ADD_ERROR":return[...e,t.value];case"REMOVE_ERROR":return e.filter((e=>e!==t.value))}return e},bucketsReducer:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;return"SET_BUCKETS"===t.type?t.value:e}})},1050:function(e,t,n){function o(e){return e.videosReducer||[]}function i(e){return e.bucketsReducer||[]}function r(e){return e.uploadsReducer||[]}function a(e){return e.UIReducer.loading||!1}function l(e){return e.errorReducer||[]}function c(e){return e.UIReducer.videosFetched||!1}function s(e){return e.UIReducer.bucketsFetched||!1}function d(e,t){return e.UIReducer[t]}n.r(t),n.d(t,{buckets:function(){return i},bucketsFetched:function(){return s},errors:function(){return l},isLoading:function(){return a},ui:function(){return d},uploads:function(){return r},videos:function(){return o},videosFetched:function(){return c}})},4396:function(e,t,n){var o=n(9818),i=n(1090),r=n(1050),a=n(4839);window.mcv_store_registed||((0,o.register)((0,o.createReduxStore)("mine-cloudvod/vod",{reducer:i.Z,selectors:r,actions:a})),window.mcv_store_registed=!0)},1101:function(e,t,n){n.d(t,{$r:function(){return l},FK:function(){return s},P$:function(){return r},RD:function(){return c},gg:function(){return d},li:function(){return a}});const{useRef:o,useEffect:i}=wp.element,r=e=>(e=>"Normal"==e.status||"Normal"==e.Status)(e),a=e=>e.status||e.Status,l=e=>null==e||null==e?"":new Date(1e3*e).toISOString().substr(11,8),c=e=>{if(null==e||0==e)return"Unknown";if(0==e)return"0 b";var t=parseInt(Math.floor(Math.log(e)/Math.log(1024)).toString());return(e/Math.pow(1024,t)).toFixed(2)+" "+["b","KB","MB","GB","TB"][t]},s=e=>{var t=(e=new Date(e)).getHours(),n=e.getMinutes(),o=e.getSeconds();return n=n<10?"0"+n:n,e.getFullYear()+"-"+(e.getMonth()+1)+"-"+e.getDate()+"  "+t+":"+n+":"+o},d=e=>{if("string"==typeof e&&e.indexOf(":")>=0){let t=e.split(":");2==t.length&&(e=parseInt(t[1])+60*parseInt(t[0])),3==t.length&&(e=parseInt(t[2])+60*parseInt(t[1])+60*parseInt(t[0])*60)}if((e=parseInt(e)-1)>0){let t=parseInt(e/60),n=e%60;jQuery('input[name="_mcv_lms_lesson_type[_mcv_lesson_duration][minute]"]').val(t),jQuery('input[name="_mcv_lms_lesson_type[_mcv_lesson_duration][second]"]').val(n)}}},8679:function(e,t,n){var o=n(9864),i={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},r={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},a={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},l={};function c(e){return o.isMemo(e)?a:l[e.$$typeof]||i}l[o.ForwardRef]={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},l[o.Memo]=a;var s=Object.defineProperty,d=Object.getOwnPropertyNames,u=Object.getOwnPropertySymbols,p=Object.getOwnPropertyDescriptor,m=Object.getPrototypeOf,v=Object.prototype;e.exports=function e(t,n,o){if("string"!=typeof n){if(v){var i=m(n);i&&i!==v&&e(t,i,o)}var a=d(n);u&&(a=a.concat(u(n)));for(var l=c(t),_=c(n),f=0;f<a.length;++f){var h=a[f];if(!(r[h]||o&&o[h]||_&&_[h]||l&&l[h])){var g=p(n,h);try{s(t,h,g)}catch(e){}}}}return t}},9921:function(e,t){var n="function"==typeof Symbol&&Symbol.for,o=n?Symbol.for("react.element"):60103,i=n?Symbol.for("react.portal"):60106,r=n?Symbol.for("react.fragment"):60107,a=n?Symbol.for("react.strict_mode"):60108,l=n?Symbol.for("react.profiler"):60114,c=n?Symbol.for("react.provider"):60109,s=n?Symbol.for("react.context"):60110,d=n?Symbol.for("react.async_mode"):60111,u=n?Symbol.for("react.concurrent_mode"):60111,p=n?Symbol.for("react.forward_ref"):60112,m=n?Symbol.for("react.suspense"):60113,v=n?Symbol.for("react.suspense_list"):60120,_=n?Symbol.for("react.memo"):60115,f=n?Symbol.for("react.lazy"):60116,h=n?Symbol.for("react.block"):60121,g=n?Symbol.for("react.fundamental"):60117,w=n?Symbol.for("react.responder"):60118,y=n?Symbol.for("react.scope"):60119;function b(e){if("object"==typeof e&&null!==e){var t=e.$$typeof;switch(t){case o:switch(e=e.type){case d:case u:case r:case l:case a:case m:return e;default:switch(e=e&&e.$$typeof){case s:case p:case f:case _:case c:return e;default:return t}}case i:return t}}}function E(e){return b(e)===u}t.AsyncMode=d,t.ConcurrentMode=u,t.ContextConsumer=s,t.ContextProvider=c,t.Element=o,t.ForwardRef=p,t.Fragment=r,t.Lazy=f,t.Memo=_,t.Portal=i,t.Profiler=l,t.StrictMode=a,t.Suspense=m,t.isAsyncMode=function(e){return E(e)||b(e)===d},t.isConcurrentMode=E,t.isContextConsumer=function(e){return b(e)===s},t.isContextProvider=function(e){return b(e)===c},t.isElement=function(e){return"object"==typeof e&&null!==e&&e.$$typeof===o},t.isForwardRef=function(e){return b(e)===p},t.isFragment=function(e){return b(e)===r},t.isLazy=function(e){return b(e)===f},t.isMemo=function(e){return b(e)===_},t.isPortal=function(e){return b(e)===i},t.isProfiler=function(e){return b(e)===l},t.isStrictMode=function(e){return b(e)===a},t.isSuspense=function(e){return b(e)===m},t.isValidElementType=function(e){return"string"==typeof e||"function"==typeof e||e===r||e===u||e===l||e===a||e===m||e===v||"object"==typeof e&&null!==e&&(e.$$typeof===f||e.$$typeof===_||e.$$typeof===c||e.$$typeof===s||e.$$typeof===p||e.$$typeof===g||e.$$typeof===w||e.$$typeof===y||e.$$typeof===h)},t.typeOf=b},9864:function(e,t,n){e.exports=n(9921)},9196:function(e){e.exports=window.React},9818:function(e){e.exports=window.wp.data},9307:function(e){e.exports=window.wp.element},7563:function(e,t,n){n.d(t,{Ab:function(){return a},Fr:function(){return l},G$:function(){return r},K$:function(){return s},MS:function(){return o},h5:function(){return c},lK:function(){return d},uj:function(){return i}});var o="-ms-",i="-moz-",r="-webkit-",a="comm",l="rule",c="decl",s="@import",d="@keyframes"},8160:function(e,t,n){n.d(t,{Ji:function(){return d},cD:function(){return s},qR:function(){return c}});var o=n(7563),i=n(6686),r=n(6411),a=n(211),l=n(5327);function c(e){var t=(0,i.Ei)(e);return function(n,o,i,r){for(var a="",l=0;l<t;l++)a+=e[l](n,o,i,r)||"";return a}}function s(e){return function(t){t.root||(t=t.return)&&e(t)}}function d(e,t,n,c){if(e.length>-1&&!e.return)switch(e.type){case o.h5:e.return=(0,l.O)(e.value,e.length);break;case o.lK:return(0,a.q)([(0,r.JG)(e,{value:(0,i.gx)(e.value,"@","@"+o.G$)})],c);case o.Fr:if(e.length)return(0,i.$e)(e.props,(function(t){switch((0,i.EQ)(t,/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":return(0,a.q)([(0,r.JG)(e,{props:[(0,i.gx)(t,/:(read-\w+)/,":"+o.uj+"$1")]})],c);case"::placeholder":return(0,a.q)([(0,r.JG)(e,{props:[(0,i.gx)(t,/:(plac\w+)/,":"+o.G$+"input-$1")]}),(0,r.JG)(e,{props:[(0,i.gx)(t,/:(plac\w+)/,":"+o.uj+"$1")]}),(0,r.JG)(e,{props:[(0,i.gx)(t,/:(plac\w+)/,o.MS+"input-$1")]})],c)}return""}))}}},2190:function(e,t,n){n.d(t,{MY:function(){return a}});var o=n(7563),i=n(6686),r=n(6411);function a(e){return(0,r.cE)(l("",null,null,null,[""],e=(0,r.un)(e),0,[0],e))}function l(e,t,n,o,a,u,p,m,v){for(var _=0,f=0,h=p,g=0,w=0,y=0,b=1,E=1,x=1,k=0,C="",S=a,Z=u,O=o,D=C;E;)switch(y=k,k=(0,r.lp)()){case 40:if(108!=y&&58==D.charCodeAt(h-1)){-1!=(0,i.Cw)(D+=(0,i.gx)((0,r.iF)(k),"&","&\f"),"&\f")&&(x=-1);break}case 34:case 39:case 91:D+=(0,r.iF)(k);break;case 9:case 10:case 13:case 32:D+=(0,r.Qb)(y);break;case 92:D+=(0,r.kq)((0,r.Ud)()-1,7);continue;case 47:switch((0,r.fj)()){case 42:case 47:(0,i.R3)(s((0,r.q6)((0,r.lp)(),(0,r.Ud)()),t,n),v);break;default:D+="/"}break;case 123*b:m[_++]=(0,i.to)(D)*x;case 125*b:case 59:case 0:switch(k){case 0:case 125:E=0;case 59+f:w>0&&(0,i.to)(D)-h&&(0,i.R3)(w>32?d(D+";",o,n,h-1):d((0,i.gx)(D," ","")+";",o,n,h-2),v);break;case 59:D+=";";default:if((0,i.R3)(O=c(D,t,n,_,f,a,m,C,S=[],Z=[],h),u),123===k)if(0===f)l(D,t,O,O,S,u,h,m,Z);else switch(g){case 100:case 109:case 115:l(e,O,O,o&&(0,i.R3)(c(e,O,O,0,0,a,m,C,a,S=[],h),Z),a,Z,h,m,o?S:Z);break;default:l(D,O,O,O,[""],Z,0,m,Z)}}_=f=w=0,b=x=1,C=D="",h=p;break;case 58:h=1+(0,i.to)(D),w=y;default:if(b<1)if(123==k)--b;else if(125==k&&0==b++&&125==(0,r.mp)())continue;switch(D+=(0,i.Dp)(k),k*b){case 38:x=f>0?1:(D+="\f",-1);break;case 44:m[_++]=((0,i.to)(D)-1)*x,x=1;break;case 64:45===(0,r.fj)()&&(D+=(0,r.iF)((0,r.lp)())),g=(0,r.fj)(),f=h=(0,i.to)(C=D+=(0,r.QU)((0,r.Ud)())),k++;break;case 45:45===y&&2==(0,i.to)(D)&&(b=0)}}return u}function c(e,t,n,a,l,c,s,d,u,p,m){for(var v=l-1,_=0===l?c:[""],f=(0,i.Ei)(_),h=0,g=0,w=0;h<a;++h)for(var y=0,b=(0,i.tb)(e,v+1,v=(0,i.Wn)(g=s[h])),E=e;y<f;++y)(E=(0,i.fy)(g>0?_[y]+" "+b:(0,i.gx)(b,/&\f/g,_[y])))&&(u[w++]=E);return(0,r.dH)(e,t,n,0===l?o.Fr:d,u,p,m)}function s(e,t,n){return(0,r.dH)(e,t,n,o.Ab,(0,i.Dp)((0,r.Tb)()),(0,i.tb)(e,2,-2),0)}function d(e,t,n,a){return(0,r.dH)(e,t,n,o.h5,(0,i.tb)(e,0,a),(0,i.tb)(e,a+1,-1),a)}},5327:function(e,t,n){n.d(t,{O:function(){return r}});var o=n(7563),i=n(6686);function r(e,t){switch((0,i.vp)(e,t)){case 5103:return o.G$+"print-"+e+e;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return o.G$+e+e;case 5349:case 4246:case 4810:case 6968:case 2756:return o.G$+e+o.uj+e+o.MS+e+e;case 6828:case 4268:return o.G$+e+o.MS+e+e;case 6165:return o.G$+e+o.MS+"flex-"+e+e;case 5187:return o.G$+e+(0,i.gx)(e,/(\w+).+(:[^]+)/,o.G$+"box-$1$2"+o.MS+"flex-$1$2")+e;case 5443:return o.G$+e+o.MS+"flex-item-"+(0,i.gx)(e,/flex-|-self/,"")+e;case 4675:return o.G$+e+o.MS+"flex-line-pack"+(0,i.gx)(e,/align-content|flex-|-self/,"")+e;case 5548:return o.G$+e+o.MS+(0,i.gx)(e,"shrink","negative")+e;case 5292:return o.G$+e+o.MS+(0,i.gx)(e,"basis","preferred-size")+e;case 6060:return o.G$+"box-"+(0,i.gx)(e,"-grow","")+o.G$+e+o.MS+(0,i.gx)(e,"grow","positive")+e;case 4554:return o.G$+(0,i.gx)(e,/([^-])(transform)/g,"$1"+o.G$+"$2")+e;case 6187:return(0,i.gx)((0,i.gx)((0,i.gx)(e,/(zoom-|grab)/,o.G$+"$1"),/(image-set)/,o.G$+"$1"),e,"")+e;case 5495:case 3959:return(0,i.gx)(e,/(image-set\([^]*)/,o.G$+"$1$`$1");case 4968:return(0,i.gx)((0,i.gx)(e,/(.+:)(flex-)?(.*)/,o.G$+"box-pack:$3"+o.MS+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+o.G$+e+e;case 4095:case 3583:case 4068:case 2532:return(0,i.gx)(e,/(.+)-inline(.+)/,o.G$+"$1$2")+e;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if((0,i.to)(e)-1-t>6)switch((0,i.uO)(e,t+1)){case 109:if(45!==(0,i.uO)(e,t+4))break;case 102:return(0,i.gx)(e,/(.+:)(.+)-([^]+)/,"$1"+o.G$+"$2-$3$1"+o.uj+(108==(0,i.uO)(e,t+3)?"$3":"$2-$3"))+e;case 115:return~(0,i.Cw)(e,"stretch")?r((0,i.gx)(e,"stretch","fill-available"),t)+e:e}break;case 4949:if(115!==(0,i.uO)(e,t+1))break;case 6444:switch((0,i.uO)(e,(0,i.to)(e)-3-(~(0,i.Cw)(e,"!important")&&10))){case 107:return(0,i.gx)(e,":",":"+o.G$)+e;case 101:return(0,i.gx)(e,/(.+:)([^;!]+)(;|!.+)?/,"$1"+o.G$+(45===(0,i.uO)(e,14)?"inline-":"")+"box$3$1"+o.G$+"$2$3$1"+o.MS+"$2box$3")+e}break;case 5936:switch((0,i.uO)(e,t+11)){case 114:return o.G$+e+o.MS+(0,i.gx)(e,/[svh]\w+-[tblr]{2}/,"tb")+e;case 108:return o.G$+e+o.MS+(0,i.gx)(e,/[svh]\w+-[tblr]{2}/,"tb-rl")+e;case 45:return o.G$+e+o.MS+(0,i.gx)(e,/[svh]\w+-[tblr]{2}/,"lr")+e}return o.G$+e+o.MS+e+e}return e}},211:function(e,t,n){n.d(t,{P:function(){return a},q:function(){return r}});var o=n(7563),i=n(6686);function r(e,t){for(var n="",o=(0,i.Ei)(e),r=0;r<o;r++)n+=t(e[r],r,e,t)||"";return n}function a(e,t,n,a){switch(e.type){case o.K$:case o.h5:return e.return=e.return||e.value;case o.Ab:return"";case o.lK:return e.return=e.value+"{"+r(e.children,a)+"}";case o.Fr:e.value=e.props.join(",")}return(0,i.to)(n=r(e.children,a))?e.return=e.value+"{"+n+"}":""}},6411:function(e,t,n){n.d(t,{FK:function(){return l},JG:function(){return u},QU:function(){return S},Qb:function(){return E},Tb:function(){return p},Ud:function(){return f},cE:function(){return y},dH:function(){return d},fj:function(){return _},iF:function(){return b},kq:function(){return x},lp:function(){return v},mp:function(){return m},q6:function(){return C},r:function(){return g},tP:function(){return h},un:function(){return w}});var o=n(6686),i=1,r=1,a=0,l=0,c=0,s="";function d(e,t,n,o,a,l,c){return{value:e,root:t,parent:n,type:o,props:a,children:l,line:i,column:r,length:c,return:""}}function u(e,t){return(0,o.f0)(d("",null,null,"",null,null,0),e,{length:-e.length},t)}function p(){return c}function m(){return c=l>0?(0,o.uO)(s,--l):0,r--,10===c&&(r=1,i--),c}function v(){return c=l<a?(0,o.uO)(s,l++):0,r++,10===c&&(r=1,i++),c}function _(){return(0,o.uO)(s,l)}function f(){return l}function h(e,t){return(0,o.tb)(s,e,t)}function g(e){switch(e){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function w(e){return i=r=1,a=(0,o.to)(s=e),l=0,[]}function y(e){return s="",e}function b(e){return(0,o.fy)(h(l-1,k(91===e?e+2:40===e?e+1:e)))}function E(e){for(;(c=_())&&c<33;)v();return g(e)>2||g(c)>3?"":" "}function x(e,t){for(;--t&&v()&&!(c<48||c>102||c>57&&c<65||c>70&&c<97););return h(e,f()+(t<6&&32==_()&&32==v()))}function k(e){for(;v();)switch(c){case e:return l;case 34:case 39:34!==e&&39!==e&&k(c);break;case 40:41===e&&k(e);break;case 92:v()}return l}function C(e,t){for(;v()&&e+c!==57&&(e+c!==84||47!==_()););return"/*"+h(t,l-1)+"*"+(0,o.Dp)(47===e?e:v())}function S(e){for(;!g(_());)v();return h(e,l)}},6686:function(e,t,n){n.d(t,{$e:function(){return f},Cw:function(){return d},Dp:function(){return i},EQ:function(){return c},Ei:function(){return v},R3:function(){return _},Wn:function(){return o},f0:function(){return r},fy:function(){return l},gx:function(){return s},tb:function(){return p},to:function(){return m},uO:function(){return u},vp:function(){return a}});var o=Math.abs,i=String.fromCharCode,r=Object.assign;function a(e,t){return(((t<<2^u(e,0))<<2^u(e,1))<<2^u(e,2))<<2^u(e,3)}function l(e){return e.trim()}function c(e,t){return(e=t.exec(e))?e[0]:e}function s(e,t,n){return e.replace(t,n)}function d(e,t){return e.indexOf(t)}function u(e,t){return 0|e.charCodeAt(t)}function p(e,t,n){return e.slice(t,n)}function m(e){return e.length}function v(e){return e.length}function _(e,t){return t.push(e),e}function f(e,t){return e.map(t).join("")}}},__webpack_module_cache__={};function __webpack_require__(e){var t=__webpack_module_cache__[e];if(void 0!==t)return t.exports;var n=__webpack_module_cache__[e]={exports:{}};return __webpack_modules__[e](n,n.exports,__webpack_require__),n.exports}__webpack_require__.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return __webpack_require__.d(t,{a:t}),t},__webpack_require__.d=function(e,t){for(var n in t)__webpack_require__.o(t,n)&&!__webpack_require__.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},__webpack_require__.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},__webpack_require__.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var __webpack_exports__={};!function(){var e=__webpack_require__(9307),t=window.wp.blocks,n=(window.wp.i18n,JSON.parse('{"u2":"mine-cloudvod/aliyun-vod"}'));function o(){return o=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},o.apply(this,arguments)}__webpack_require__(4396);var i=__webpack_require__(917),r=__webpack_require__(1101);const{Button:a,BaseControl:l,Disabled:c,Card:s,CardBody:d}=wp.components,{useState:u,useContext:p,useEffect:m}=wp.element,{dispatch:v,useSelect:_}=wp.data;var f=()=>{const[e,t]=u(!1),[n,o]=u(!1),[p,f]=u(null),h=_((e=>e("mine-cloudvod/vod").ui("selectedId"))),g=_((e=>e("mine-cloudvod/vod").videos()));m((()=>{g&&f(h?g.find((e=>e.videoId===h)):null)}),[g,h]);const w=i.iv`
    margin-top: 5px;
    word-break: break-all;
  `;if(!p)return"";const y=e=>e.coverURL;return p&&(0,i.tZ)("div",{className:"mine-cloudvod__media-modal-sidebar-content"},(0,i.tZ)(l,{css:i.iv`
            position: relative;
          `},(0,i.tZ)(c,{key:p.videoId},(0,r.P$)(p)&&y(p)&&(0,i.tZ)("img",{src:y(p),css:{maxWidth:"100%",maxHeight:"200px"}})),(0,i.tZ)(a,{isSmall:!0,isPrimary:!0,isBusy:!(0,r.P$)(p),css:i.iv`
              ${(0,r.P$)(p)?"position: absolute;":""}
              top: 8px;
              right: 8px;
              font-size: 11px;
              color: #ffffff;
              padding: 2px 10px;
              border-radius: 9999px;
            `},(0,r.li)(p))),(0,i.tZ)(l,null,(0,i.tZ)(l.VisualLabel,null,wp.i18n.__("Name","mine-cloudvod")),(0,i.tZ)("h3",{css:w},p.title)),(0,i.tZ)(l,null,(0,i.tZ)(l.VisualLabel,null,wp.i18n.__("Category","mine-cloudvod")),(0,i.tZ)("h3",{css:w},p.cateName)),(0,i.tZ)(l,null,(0,i.tZ)(l.VisualLabel,null,wp.i18n.__("Size","mine-cloudvod")),(0,i.tZ)("h3",{css:w},(0,r.RD)(p.size||0))),(0,i.tZ)(l,null,(0,i.tZ)(l.VisualLabel,null,wp.i18n.__("Length","mine-cloudvod")),(0,i.tZ)("h3",{css:w},(0,r.$r)(p.duration))),(0,i.tZ)(l,null,(0,i.tZ)(l.VisualLabel,null,wp.i18n.__("Created","mine-cloudvod")),(0,i.tZ)("h3",{css:w},(0,r.FK)(p.creationTime))),(0,i.tZ)(l,null,e?(0,i.tZ)(s,null,(0,i.tZ)(d,null,(0,i.tZ)("p",null,(0,i.tZ)("strong",null,wp.i18n.__("Are you sure?","mine-cloudvod"))),(0,i.tZ)("p",null,wp.i18n.__("Are you sure you want to delete this video?","mine-cloudvod")),(0,i.tZ)(a,{isDestructive:!0,disabled:n,isBusy:n,onClick:e=>{e.preventDefault(),(async()=>{await wp.apiFetch({path:"mine-cloudvod/v1/aliyun/vod/delvideo",method:"DELETE",data:{videoId:p.videoId}}),v("mine-cloudvod/vod").removeVideo(p),v("mine-cloudvod/vod").setUI("selectedId",null),o(!1),t(!1)})(),o(!0)}},wp.i18n.__("Yes","mine-cloudvod")),(0,i.tZ)(a,{onClick:()=>t(!1)},wp.i18n.__("Cancel","mine-cloudvod")))):(0,i.tZ)(a,{isDestructive:!0,onClick:()=>{t(!e)}},wp.i18n.__("Delete video","mine-cloudvod"))))},h=e=>{const{thumbnail:t,title:n,footer:r,before:a,after:l}=e;return(0,i.tZ)("div",o({css:i.iv`
        cursor: pointer;
        user-select: none;
        display: inline-block;
        position: relative;
        margin-right: 20px;
        font-weight: bold;
        margin-bottom: 20px;
        width: 220px;
        flex: 0 0 220px;
        border: 1px solid #e0e0e0;
        border-radius: 4px;
        overflow: hidden;
      `},e),!!a&&a,!!t&&t,(0,i.tZ)("div",{css:i.iv`
          margin: 14px;
        `},!!n&&(0,i.tZ)("span",{css:i.iv`
              text-overflow: ellipsis;
              white-space: nowrap;
              overflow: hidden;
              width: 100%;
              max-width: 100%;
              display: inline-block;
              line-height: 20px;
              font-size: 13px;
            `},n),!!r&&(0,i.tZ)("div",{css:i.iv`
              font-size: 12px;
              opacity: 0.75;
              margin-bottom: 7px;
            `},r)),!!l&&l)};const{Icon:g,Button:w}=wp.components,{useEffect:y,useState:b}=wp.element,{useSelect:E,dispatch:x}=wp.data;var k=e=>{let{video:t}=e;const[n,o]=b(),a=E((e=>e("mine-cloudvod/vod").ui("selectedId")));return y((()=>{o(a?a===t.videoId:null)}),[a]),(0,i.tZ)(h,{onClick:()=>{x("mine-cloudvod/vod").setUI("selectedId",t.videoId)},css:i.iv`
        ${n&&"box-shadow: 0 0 0 0px #fff, 0 0 0 3px var(--wp-admin-theme-color, #007cba);"}
        border: 1px solid
          ${n?"var(--wp-admin-theme-color, #007cba)":"#e0e0e0"};
      `,thumbnail:(()=>{const e=t.coverURL;if(e)return(0,i.tZ)("img",{css:i.iv`
            max-width: 100%;
            object-fit: cover;
            width: 100%;
            height: 140px;
            display: block;
          `,src:e})})(),badge:(0,i.tZ)(w,{isSmall:!0,isPrimary:!0,isBusy:!(0,r.P$)(t),css:i.iv`
        font-size: 11px;
        color: #ffffff;
        padding: 2px 10px;
        border-radius: 9999px;
      `},(0,r.li)(t)),title:t.title,footer:(0,i.tZ)("div",{css:i.iv`
        display: flex;
        align-items: center;
      `},(0,i.tZ)("span",{css:i.iv`
          margin-right: 10px;
          display: flex;
          align-items: center;
        `},(0,i.tZ)(g,{css:i.iv`
            width: 14px;
            height: 14px;
            font-size: 14px;
            margin-right: 5px;
            opacity: 0.5;
          `,icon:"clock",size:14}),(0,i.tZ)("span",null,(0,r.$r)(t.duration))),(0,i.tZ)("span",{css:i.iv`
          display: flex;
          align-items: center;
        `},(0,i.tZ)(g,{css:i.iv`
            opacity: 0.5;
            width: 14px;
            height: 14px;
            font-size: 14px;
            margin-right: 5px;
          `,icon:"database",size:14}),(0,i.tZ)("span",null,(0,r.RD)(t.size)))),after:""})},C=__webpack_require__(4712);const{useState:S,useEffect:Z,Fragment:O}=wp.element,{Flex:D,FormFileUpload:I,Notice:P,Button:M}=wp.components,{dispatch:A,useSelect:U}=wp.data;var T=e=>{let{mediaType:t}=e;const[n,o]=S(!1),[r,a]=S(""),[l,c]=S(0),[s,d]=S(""),[u,p]=S(!1),m=100,v=U((e=>e("mine-cloudvod/vod").videosFetched())),_=U((e=>e("mine-cloudvod/vod").videos())),f=U((e=>e("mine-cloudvod/vod").uploads())),h=U((e=>e("mine-cloudvod/vod").ui("currentCategory"))),g=U((e=>e("mine-cloudvod/vod").ui("pageNo"))),w=U((e=>e("mine-cloudvod/vod").ui("alivod_keyword")));Z((()=>{v||y()}),[v]);const y=async function(){let{sync:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{sync:!1};try{const e=await wp.apiFetch({path:wp.url.addQueryArgs("mine-cloudvod/v1/aliyun/vod/videos",{page:g,items_per_page:m,cateId:h?h.cateId:-1,search:w,searchType:t})});A("mine-cloudvod/vod").setVideos(e.items),d(e.scrollToken),A("mine-cloudvod/vod").setUI("pageNo",g?g+1:2),c(e.totalItems),a("")}catch(t){e||A("mine-cloudvod/vod").addError(t.message)}finally{A("mine-cloudvod/vod").setVideosFetched(!0)}};return r?(0,i.tZ)(P,{status:"warning",isDismissible:!1},(0,i.tZ)("div",{css:{display:"flex",alignItems:"center"}},(0,i.tZ)(C.Z,{css:{flex:1}}),r)):v?(0,i.tZ)(O,null,_&&_.length?(0,i.tZ)("div",{key:"mcv-alivod-videos"},(0,i.tZ)("h2",null,wp.i18n.__("Videos","mine-cloudvod")),_.map((e=>(0,i.tZ)(k,{key:e.videoId,video:e,onClick:()=>{o(n.videoId===e.videoId?{}:e)},selected:n.videoId===e.videoId}))),(0,i.tZ)("div",{css:i.iv`
            text-align:center;
          `,key:"mcv-alivod-videos-loadmore"},u&&(0,i.tZ)(C.Z,{css:{flex:1,marginBottom:10}}),(0,i.tZ)("p",null,sprintf(wp.i18n.__("Showing %1$s of %2$s media items","mine-cloudvod"),_.length,l)),_.length<l&&(0,i.tZ)(M,{isPrimary:!0,size:"small",onClick:e=>{e.preventDefault(),async function(){let{sync:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{sync:!1};try{p(!0);const e=await wp.apiFetch({path:wp.url.addQueryArgs("mine-cloudvod/v1/aliyun/vod/videos",{page:g,items_per_page:m,cateId:h?h.cateId:-1,st:s})});A("mine-cloudvod/vod").addVideos(e.items),d(e.scrollToken),A("mine-cloudvod/vod").setUI("pageNo",g?g+1:2),a("")}catch(t){e||A("mine-cloudvod/vod").addError(t.message)}finally{p(!1)}}()}},wp.i18n.__("Load more")))):(0,i.tZ)(D,{align:"center",justify:"center",css:i.iv`
          height: 100%;
          text-align: center;
        `},(0,i.tZ)("div",null,(0,i.tZ)("h2",null,wp.i18n.__("Drop video files here to upload","mine-cloudvod")),(0,i.tZ)("p",null,wp.i18n.__("or browse for a video","mine-cloudvod")),(0,i.tZ)(I,{isSecondary:!0,accept:"video/mp4,video/x-m4v,video/*",onChange:e=>{if(e.target.files){for(var t=0;t<e.target.files.length;t++)e.target.files[t].id=t+f.length;A("mine-cloudvod/vod").addUploads(e.target.files),jQuery(e.target).val(null)}}},wp.i18n.__("Upload New Video","mine-cloudvod"))))):(0,i.tZ)(C.Z,{css:{flex:1}})};const{Button:F,TextControl:B,Modal:R,BaseControl:$}=wp.components,{useState:N,Fragment:L}=wp.element,{dispatch:V,useSelect:j}=wp.data;var G=()=>{const[e,t]=N(""),[n,o]=N(!1),r=j((e=>e("mine-cloudvod/vod").ui("Categories"))),a=j((e=>e("mine-cloudvod/vod").ui("createCollection"))),l=e=>{V("mine-cloudvod/vod").setUI("createCollection",e)};return(0,i.tZ)(L,null,(0,i.tZ)(F,{isSecondary:!0,onClick:()=>l(!0)},wp.i18n.__("Create Category","mine-cloudvod")),a&&(0,i.tZ)(R,{overlayClassName:"mcv-modal",title:wp.i18n.__("Create New Category","mine-cloudvod"),shouldCloseOnClickOutside:!1,isDismissible:!1},(0,i.tZ)(B,{css:i.iv`
              margin-bottom: 15px;
            `,tabIndex:"0",placeholder:wp.i18n.__("Enter a category name","mine-cloudvod"),value:e,onChange:e=>t(e)}),(0,i.tZ)($,null,(0,i.tZ)(F,{isBusy:n,disabled:n,isPrimary:!0,onClick:()=>{(async()=>{o(!0);try{let n=await wp.apiFetch({path:"mine-cloudvod/v1/aliyun/vod/createCategory",method:"POST",data:{name:e}});r.push(n),V("mine-cloudvod/vod").setUI("Categories",r),V("mine-cloudvod/vod").setUI("currentCategory",n),V("mine-cloudvod/vod").setVideosFetched(!1),t(""),l(!1)}catch(e){console.error(e)}finally{o(!1)}})()}},wp.i18n.__("Create","mine-cloudvod"))," ",(0,i.tZ)(F,{onClick:()=>l(!1)},wp.i18n.__("Cancel","mine-cloudvod")))))};const{Flex:K,FlexBlock:q,FlexItem:z,Button:W,FormFileUpload:Q,TextControl:H}=wp.components,{dispatch:J,useSelect:X}=wp.data,{useState:Y}=wp.element;var ee=e=>{let{uploads:t,afterUpload:n,onSearch:o,mediaType:r}=e;const[a,l]=Y("");var c="video/mp4,video/x-m4v,video/*";return"audio"==r&&(c="audio/mp3"),(0,i.tZ)(K,null,(0,i.tZ)(q,null,(0,i.tZ)(K,{justify:"flex-start"},(0,i.tZ)(Q,{id:"mcv-oss-upload-form",multiple:!0,isPrimary:!0,accept:c,onChange:e=>{if(e.target.files){for(var t=0;t<e.target.files.length;t++)e.target.files[t].id=t+e.target.files.length;J("mine-cloudvod/vod").addUploads(e.target.files),jQuery(e.target).val(null)}}},"audio"==r?wp.i18n.__("Upload Audios","mine-cloudvod"):wp.i18n.__("Upload Videos","mine-cloudvod")),(0,i.tZ)(G,null),n)),(0,i.tZ)(z,null,(0,i.tZ)(K,{align:"stretch"},(0,i.tZ)("input",{css:i.iv`
                height: 36px;
              `,tabIndex:"0",placeholder:"audio"==r?wp.i18n.__("Search for a audio...","mine-cloudvod"):wp.i18n.__("Search for a video...","mine-cloudvod"),value:a,onChange:e=>{l(e.target.value)}}),(0,i.tZ)(W,{isPrimary:!0,onClick:e=>{e.preventDefault(),o&&o(a)}},wp.i18n.__("Search","mine-cloudvod")," / ",wp.i18n.__("Reload","mine-cloudvod")))))};const{Icon:te}=wp.components;var ne=e=>{let{children:t,onClick:n}=e;return(0,i.tZ)("span",{onClick:n,css:i.iv`display: inline-flex; align-items: center; cursor: pointer; color: var(--wp-admin-theme-color, #007cba); padding: 6px 0;`},(0,i.tZ)(te,{css:i.iv`width: 14px;height: 14px;font-size: 14px;margin-right: 5px;`,icon:"arrow-left-alt",size:14}),(0,i.tZ)("span",null,t))};const{useState:oe}=wp.element,{dispatch:ie,useSelect:re}=wp.data,{Button:ae,Modal:le,BaseControl:ce}=wp.components;var se=()=>{const e=re((e=>e("mine-cloudvod/vod").ui("currentCategory")));return(0,i.tZ)("div",{css:i.iv`
        margin-bottom: 2em;
        display: flex;
        align-items: center;
        justify-content: space-between;
        border-bottom: 1px solid #ccc;
      `},(0,i.tZ)("div",null,(0,i.tZ)(ne,{onClick:()=>{ie("mine-cloudvod/vod").setUI("currentCategory",null),ie("mine-cloudvod/vod").setUI("pageNo",1),ie("mine-cloudvod/vod").setVideosFetched(!1)}},wp.i18n.__("Back To All Videos","mine-cloudvod")),(0,i.tZ)("h2",null,e.cateName)))};const{Icon:de}=wp.components,{dispatch:ue}=wp.data;var pe=e=>{let{category:t}=e;return(0,i.tZ)("div",{onClick:e=>{e.preventDefault(),ue("mine-cloudvod/vod").setUI("currentCategory",t),ue("mine-cloudvod/vod").setUI("pageNo",1),ue("mine-cloudvod/vod").setVideosFetched(!1)},css:i.iv`margin-right: 15px;padding: 5px 0;cursor: pointer;font-weight: bold;line-height: 20px;`},(0,i.tZ)(de,{icon:"category",css:i.iv`color: var(--wp-admin-theme-color);margin-right: 5px;`}),t.cateName)};const{useEffect:me}=wp.element,{useSelect:ve,dispatch:_e}=wp.data;var fe=()=>{const e=ve((e=>e("mine-cloudvod/vod").ui("Categories")));return me((()=>{(async()=>{try{const e=await wp.apiFetch({path:wp.url.addQueryArgs("mine-cloudvod/v1/aliyun/vod/categories",{})});_e("mine-cloudvod/vod").setUI("Categories",e)}catch(e){if(401===e.data.status)return;_e("mine-cloudvod/vod").addError(e.message)}})()}),[]),!!e&&(0,i.tZ)("div",null,(0,i.tZ)("h2",null,wp.i18n.__("Categories","mine-cloudvod")),(0,i.tZ)("div",{css:i.iv`display: flex;align-items: stretch;overflow: auto;flex-wrap: wrap;`},e.map((e=>(0,i.tZ)(pe,{category:e,key:"key_"+e.cateId})))))};const{Button:he}=wp.components,{useState:ge,useEffect:we}=wp.element,{useSelect:ye}=wp.data;var be=t=>{let{onChoose:n}=t;const[o,i]=ge(null),[r,a]=ge(!1),l=ye((e=>e("mine-cloudvod/vod").ui("selectedId"))),c=ye((e=>e("mine-cloudvod/vod").videos()));return we((()=>{i(l?c.find((e=>e.videoId===l)):null)}),[c,l]),we((()=>{o&&"Normal"==o.status?a(!0):a(o&&"Normal"==o.status)}),[o]),(0,e.createElement)(he,{isPrimary:!0,disabled:!r,onClick:()=>n(o)},r?wp.i18n.__("Choose","mine-cloudvod"):wp.i18n.__("Please Choose...","mine-cloudvod"))},Ee=__webpack_require__(5174);const{dispatch:xe,useSelect:ke}=wp.data,{useState:Ce}=wp.element;var Se=e=>{let{uploader:t,uploads:n,error:o}=e;return n.length?(0,i.tZ)("div",{css:i.iv`
        overflow: auto;
        display: flex;
        align-items: center;
        position: relative;
      `},n.length&&n.map((e=>(t.addFile(e,null,null,null,'{"Vod":{}}'),(0,i.tZ)("div",{key:"key_"+e.id,css:i.iv`
                display: flex;
                align-items: center;
                justify-content: space-between;
                animation: components-button__busy-animation 2500ms infinite linear;
                opacity: 1;
                padding: 6px 12px;
                border-radius: 99999px;
                border: 1px solid #dddddd;
                background-size: 100px 100%;
                background-image: linear-gradient(
                  -45deg,
                  #ffffff 33%,
                  #f3f3f3 33%,
                  #f3f3f3 70%,
                  #ffffff 70%
                );
              `},(0,i.tZ)("div",{css:i.iv`
                  flex: 1;
                  white-space: nowrap;
                  overflow: hidden;
                  max-width: 150px;
                  text-overflow: ellipsis;
                  font-weight: bold;
                `},!!o&&o,e.name,"..."),(0,i.tZ)("div",{css:i.iv`
                  display: flex;
                  align-items: center;
                `},(0,i.tZ)(Ee.Z,{css:i.iv`
                    width: 50px;
                    height: 3px;
                    margin: 0 5px;
                    background: #e3e3e3;
                    border-radius: 9999px;
                    overflow: hidden;
                  `,id:e.id,progress:0}))))))):""},Ze=__webpack_require__(9866);const{Button:Oe,DropZone:De,Notice:Ie}=wp.components,{useState:Pe,useEffect:Me,Fragment:Ae}=wp.element,{dispatch:Ue,useSelect:Te}=wp.data;var Fe=e=>{let{onClose:t,onChoose:n,mediaType:o}=e;const[r,a]=Pe(""),l=Te((e=>e("mine-cloudvod/vod").uploads())),c=Te((e=>e("mine-cloudvod/vod").errors())),s=Te((e=>e("mine-cloudvod/vod").ui("currentCategory")));Me((()=>{Ue("mine-cloudvod/vod").setVideosFetched(!1),Ue("mine-cloudvod/vod").setVideos([])}),[]);const d="audio"==o?wp.i18n.__("Select or Upload AliyunVod Audio","mine-cloudvod"):wp.i18n.__("Select or Upload AliyunVod Video","mine-cloudvod");var u=new window.AliyunUpload.Vod({timeout:6e4,partSize:2097152,parallel:5,retryCount:3,retryDuration:2,region:mcv_alivod_config.endpoint,userId:mcv_alivod_config.userId,addFileSuccess:function(e){console.log("addFileSuccess: "+e.file.name),u._uploadList.length==l.length&&u.startUpload()},onUploadstarted:function(e){if(e.videoId){var t=ajaxurl;jQuery.post(t,{action:"mcv_alivod_upload",op:"refreshuvinfo",endpoint:this.region,nonce:mcv_alivod_config.nonce,FileName:e.file.name,VideoId:e.videoId,mediaType:o},(function(t){var n=t.UploadAuth,o=t.UploadAddress,i=t.VideoId;u.setUploadAuthAndAddress(e,n,o,i)}),"json")}else{var n=ajaxurl;jQuery.post(n,{action:"mcv_alivod_upload",op:"getuvinfo",endpoint:this.region,nonce:mcv_alivod_config.nonce,FileName:e.file.name,FileSize:e.file.size,cateId:s?s.cateId:0,mediaType:o},(function(t){if(0==t.status)a(t.msg);else{var n=t.UploadAuth,o=t.UploadAddress,i=t.VideoId;u.setUploadAuthAndAddress(e,n,o,i)}}),"json"),console.log("onUploadStarted:"+e.file.name+", endpoint:"+e.region+", bucket:"+e.bucket+", object:"+e.object)}},onUploadSucceed:function(e){jQuery.post(ajaxurl,{action:"mcv_alivod_upload",op:"uvsucceed",endpoint:this.region,nonce:mcv_alivod_config.nonce,FileName:e.file.name,VideoId:e.videoId,from:"block",mediaType:o},(function(e){}),"json"),console.log(e)},onUploadFailed:function(e,t,n){console.log("onUploadFailed: file:"+e.file.name+",code:"+t+", message:"+n)},onUploadCanceled:function(e,t,n){console.log("Canceled file: "+e.file.name+", code: "+t+", message:"+n)},onUploadProgress:function(e,t,n){var o=Math.ceil(100*n);jQuery("#mcv_progress_"+e.file.id).css("width",o+"%")},onUploadTokenExpired:function(e){let t=ajaxurl;jQuery.post(t,{action:"mcv_alivod_upload",op:"refreshuvinfo",endpoint:this.region,nonce:mcv_alivod_config.nonce,FileName:e.file.name,VideoId:e.videoId,mediaType:o},(function(e){var t=e.UploadAuth;u.resumeUploadWithAuth(t),console.log("upload expired and resume upload with uploadauth "+t)}),"json")},onUploadEnd:function(e){Ue("mine-cloudvod/vod").setUploads([]),setTimeout((function(){Ue("mine-cloudvod/vod").setUI("pageNo",1),Ue("mine-cloudvod/vod").setVideosFetched(!1)}),2e3),console.log("onUploadEnd: uploaded all the files")}});const p=(0,i.tZ)(ee,{afterUpload:(0,i.tZ)(Se,{uploader:u,uploads:l,error:r}),onSearch:e=>{Ue("mine-cloudvod/vod").setUI("pageNo",1),Ue("mine-cloudvod/vod").setUI("alivod_keyword",e),Ue("mine-cloudvod/vod").setVideosFetched(!1)},mediaType:o}),m=(0,i.tZ)(f,null),v=(0,i.tZ)(be,{onChoose:n});return(0,i.tZ)(Ze.Z,{title:d,header:p,mainContent:(0,i.tZ)("div",{css:i.iv`
           overflow: auto;
           display: flex;
           flex-direction: column;
         `},(0,i.tZ)("div",{css:i.iv`
             padding: 12px 24px;
             overflow: auto;
             display: flex;
             flex-direction: column;
           `},!!c.length&&c.map((e=>(0,i.tZ)(Ie,{key:e,css:i.iv`
                     margin: 0 0 20px 0;
                   `,status:"error",onRemove:()=>Ue("mine-cloudvod/vod").removeError(e)},e))),s?(0,i.tZ)(se,null):(0,i.tZ)(fe,null),(0,i.tZ)("div",{css:i.iv`
               display: flex;
               align-items: stretch;
             `},(0,i.tZ)(T,{mediaType:o})),(0,i.tZ)(De,{label:"Drop files",onFilesDrop:e=>{for(var t=0;t<e.length;t++)e[t].id=t+l.length;Ue("mine-cloudvod/vod").addUploads(e)}}))),onClose:()=>{l.length?confirm("Discard your uploads?")&&(t(),Ue("mine-cloudvod/vod").setUploads([])):(Ue("mine-cloudvod/vod").setUI("pageNo",1),Ue("mine-cloudvod/vod").setUI("alivod_keyword",""),t())},footer:v,sidebar:m})},Be=__webpack_require__(3572),Re=function(){return Re=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},Re.apply(this,arguments)};const{useEffect:$e,useRef:Ne,useMemo:Le,useState:Ve}=wp.element,{Spinner:je,Placeholder:Ge}=wp.components;var Ke=t=>{let{attributes:n}=t;try{window.Aliplayer.__unable2Anti9Debugger13Key="error";const{source:t,width:i,height:r,videoId:a,cover:l,autoplay:c,captions:s,live:d,oss:u,cos:p}=n;var o={vid:a,source:t||"",width:i,height:r,autoplay:c||!1,isLive:d||!1,rePlay:!1,playsinline:!0,preload:!0,controlBarVisibility:"hover",useH5Prism:!0,cover:l,components:[{name:"RateComponent",type:AliPlayerComponent.RateComponent}]};u&&(o.oss=u);const[m,v]=Ve(!0),_=Ne(null),f=Le((()=>"aliplayer-"+Math.floor(1e6*Math.random())),[i,r,a,l,c,s,d,u]);$e((()=>{if(f)if(v(!0),u&&u.key){if(!document.getElementById(f))return;wp.apiFetch({path:wp.url.addQueryArgs("mine-cloudvod/v1/aliyun/oss/playurl",{object:u.key,bucket:u.bucket})}).then((e=>{v(!1),e.status&&(_.current=new window.Aliplayer(Re(o,{id:f,source:e.data,oss:void 0}),(function(e){jQuery("#"+f).css("padding-top","56.25%"),console.log("The player is created")})))}))}else if(t)setTimeout((function(){document.getElementById(f)&&(v(!1),_.current=new window.Aliplayer(Re(o,{id:f}),(function(e){jQuery("#"+f).css("padding-top","56.25%"),console.log("The player is created")})))}),2e3);else if(p&&p.key){if(!document.getElementById(f))return;wp.apiFetch({path:wp.url.addQueryArgs("mine-cloudvod/v1/qcloud/cos/playurl",{object:p.key,bucket:p.bucket})}).then((e=>{v(!1),e.status&&(_.current=new window.Aliplayer(Re(o,{id:f,source:e.data,cos:void 0}),(function(e){jQuery("#"+f).css("padding-top","56.25%"),console.log("The player is created")})))}))}else{if(!document.getElementById(f))return;wp.apiFetch({path:wp.url.addQueryArgs("mine-cloudvod/v1/aliyun/vod/playauth",{vid:a,endpoint:mcv_alivod_config.endpoint})}).then((e=>{v(!1);try{e?.encrypt||!e.hls?_.current=new window.Aliplayer(Re(o,{id:f,playauth:e.playauth,encryptType:1}),(function(e){jQuery("#"+f).css("padding-top","56.25%"),console.log("The player is created")})):_.current=new window.Aliplayer(Re(o,{id:f,playauth:"",vid:"",source:JSON.stringify(e.hls),encryptType:1}),(function(e){jQuery("#"+f).css("padding-top","56.25%"),console.log("The player is created")}))}catch(e){}}))}}),[f,i,r,a,l,c,s,d,u]);const h=m?(0,e.createElement)(Ge,{className:"mine-cloudvod__placeholder is-loading"},(0,e.createElement)(je,null)," ",wp.i18n.__("Aliplayer is initializing, please wait...","mine-cloudvod")):null;let g={id:f};return wp.element.createElement("div",g,h)}catch(e){}};const{Flex:qe,FlexItem:ze,FlexBlock:We,TextControl:Qe,Button:He}=wp.components,{useState:Je}=wp.element;var Xe=t=>{let{update:n,add:o,remove:i,className:r,time:a,title:l,disabled:c,showNotice:s}=t;const[d,u]=Je(a);return(0,e.createElement)(qe,{align:"center",className:r},(0,e.createElement)(ze,null,(0,e.createElement)(Qe,{style:{width:"60px"},placeholder:"0",value:d,onChange:e=>u(e),onBlur:()=>{let e=(e=>{let t=e+"";return t?(t=t.replace(/[^\d]/g,""),t=parseInt(t),t):0})(d);n({time:e}),u(e)},autoComplete:"off"})),(0,e.createElement)(We,null,(0,e.createElement)(Qe,{placeholder:wp.i18n.__("Title","mine-cloudvod"),value:l||"",onChange:e=>n({title:e}),autoComplete:"off"})),(0,e.createElement)(ze,null,i&&(0,e.createElement)(He,{icon:"minus",style:{marginBottom:"8px"},label:wp.i18n.__("Remove Marker","mine-cloudvod"),onClick:i}),o&&(0,e.createElement)(He,{icon:"plus-alt",label:wp.i18n.__("Add Marker","mine-cloudvod"),style:{marginBottom:"8px"},onClick:()=>{o(),u("")}})))};const{useState:Ye}=wp.element;var et=t=>{let{setAttributes:n,attributes:o}=t;const{markers:i}=o;let[r,a]=Ye({title:"",time:""});return(0,e.createElement)("div",null,(i||[]).sort((function(e,t){return parseInt(e.time)-parseInt(t.time)})).map(((t,o)=>(0,e.createElement)(Xe,{key:`${o}-${t.time}`,time:t.time,title:t.title,marker:t,update:e=>{!function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=i.indexOf(e),r=i.map(((e,n)=>n!==o?e:{...e,...t}));n({markers:r})}(t,e)},remove:()=>{(e=>{let t=i.indexOf(e);n({markers:i.filter(((e,n)=>n!==t))})})(t)}}))),(0,e.createElement)(Xe,{time:r.time,title:r.title,update:e=>{a({...r,...e})},add:()=>{r.time&&r.title&&(n({markers:[...i||[],{time:r.time,title:r.title}]}),a({title:"",time:""}))}}))};const{sprintf:tt}=wp.i18n,{NavigableMenu:nt,MenuItem:ot,FormFileUpload:it,MenuGroup:rt,ToolbarGroup:at,ToolbarButton:lt,Dropdown:ct,SVG:st,Rect:dt,Path:ut,Button:pt,TextControl:mt,SelectControl:vt,Flex:_t,FlexItem:ft,FlexBlock:ht}=wp.components,{MediaUpload:gt,MediaUploadCheck:wt}=wp.blockEditor,{useSelect:yt}=wp.data,{useState:bt}=wp.element,Et=["text/vtt"],xt="subtitles";function kt(t){let n,{tracks:o,onEditPress:i}=t;return n=0===o.length?(0,e.createElement)("p",null,wp.i18n.__("Captions are .vtt files that help make your content more accesible to a wider range of users.","mine-cloudvod")):o.map(((t,n)=>(0,e.createElement)("div",{key:n,className:"block-library-video-tracks-editor__track-list-track"},(0,e.createElement)("span",null,t.label," "),(0,e.createElement)(pt,{isTertiary:!0,onClick:()=>i(n),"aria-label":tt(/* translators: %s: Label of the video text track e.g: "French subtitles" */
wp.i18n.__("Edit %s","mine-cloudvod"),t.label)},wp.i18n.__("Edit","mine-cloudvod"))))),(0,e.createElement)(rt,{label:wp.i18n.__("Captions","mine-cloudvod"),className:"block-library-video-tracks-editor__track-list"},n)}function Ct(t){let{track:n,onChange:o,onClose:i,onRemove:r}=t;const{src:a="",label:l="",lang:c="",kind:s=xt}=n,d=a.startsWith("blob:")?"":a.substring(a.lastIndexOf("/")+1);return(0,e.createElement)(nt,null,(0,e.createElement)("div",{className:"block-library-video-tracks-editor__single-track-editor"},(0,e.createElement)("span",{className:"block-library-video-tracks-editor__single-track-editor-edit-track-label"},wp.i18n.__("Edit caption track","mine-cloudvod")),(0,e.createElement)("span",null,wp.i18n.__("File","mine-cloudvod"),": ",(0,e.createElement)("b",null,d)),(0,e.createElement)("div",{className:"block-library-video-tracks-editor__single-track-editor-label-language"},(0,e.createElement)(mt,{autoFocus:!0,onChange:e=>o({...n,label:e}),label:wp.i18n.__("Caption title","mine-cloudvod"),value:l}),(0,e.createElement)(mt,{onChange:e=>o({...n,lang:e}),label:wp.i18n.__("Language tag","mine-cloudvod"),value:c})),(0,e.createElement)("div",{className:"block-library-video-tracks-editor__single-track-editor-buttons-container"},(0,e.createElement)(pt,{isSecondary:!0,onClick:()=>{const e={};let t=!1;""===l&&(e.label=wp.i18n.__("English","mine-cloudvod"),t=!0),""===c&&(e.lang="en",t=!0),t&&o({...n,...e}),i()}},wp.i18n.__("Close","mine-cloudvod")),(0,e.createElement)(pt,{isDestructive:!0,isLink:!0,onClick:r},wp.i18n.__("Remove caption","mine-cloudvod")))))}function St(t){let{captions:n=[],onChange:o}=t;const i=yt((e=>e("core/block-editor").getSettings().mediaUpload),[]),[r,a]=bt(null),[l,c]=bt();return i?(0,e.createElement)(ct,{contentClassName:"block-library-video-tracks-editor",renderToggle:t=>{let{isOpen:n,onToggle:o}=t;return(0,e.createElement)(at,null,(0,e.createElement)(lt,{label:wp.i18n.__("Captions","mine-cloudvod"),showTooltip:!0,"aria-expanded":n,"aria-haspopup":"true",onClick:o},wp.i18n.__("Captions","mine-cloudvod")))},renderContent:t=>{let{}=t;return null!==r?(0,e.createElement)(Ct,{track:n[r],onChange:e=>{const t=[...n];t[r]=e,o(t)},onClose:()=>a(null),onRemove:()=>{o(n.filter(((e,t)=>t!==r))),a(null)}}):(0,e.createElement)("div",null,(0,e.createElement)(nt,null,(0,e.createElement)(kt,{tracks:n,onEditPress:a}),(0,e.createElement)(rt,{className:"block-library-video-tracks-editor__add-tracks-container",label:wp.i18n.__("Add caption languages","mine-cloudvod")},(0,e.createElement)(gt,{onSelect:e=>{let{url:t}=e;const i=n.length;o([...n,{src:t}]),a(i)},allowedTypes:Et,render:t=>{let{open:n}=t;return(0,e.createElement)(ot,{icon:"media",onClick:n},wp.i18n.__("Open Media Library","mine-cloudvod"))}}),(0,e.createElement)(wt,null,(0,e.createElement)(it,{onChange:e=>{const t=e.target.files,r=n.length;i({allowedTypes:Et,filesList:t,onFileChange:e=>{let[{url:t}]=e;const i=[...n];i[r]||(i[r]={}),i[r]={...n[r],src:t},o(i),a(r)}})},accept:".vtt,text/vtt",render:t=>{let{openFileDialog:n}=t;return(0,e.createElement)(ot,{icon:"upload",onClick:()=>{n()}},wp.i18n.__("Upload","mine-cloudvod"))}}))),(0,e.createElement)(rt,{className:"block-library-video-tracks-editor__add-tracks-container",label:wp.i18n.__("Add External Subtitle","mine-cloudvod")},(0,e.createElement)("form",{onSubmit:e=>{e.preventDefault();const t=n.length;o([...n,{src:l}]),a(t),c("")}},(0,e.createElement)(_t,{style:{width:"100%"}},(0,e.createElement)(ht,null,(0,e.createElement)(mt,{type:"url",placeholder:wp.i18n.__("External Subtitle Link","mine-cloudvod"),value:l,onChange:e=>c(e)})),(0,e.createElement)(ft,null,(0,e.createElement)(pt,{isPrimary:!0,style:{marginBottom:"8px"},type:"submit"},wp.i18n.__("Add","mine-cloudvod")))),(0,e.createElement)("p",null,wp.i18n.__("Attention: External subtitles may cause cross-domain issues.","mine-cloudvod"))))))}}):null}const{Flex:Zt,FlexItem:Ot,FlexBlock:Dt,TextControl:It,Button:Pt}=wp.components,{useState:Mt}=wp.element,{MediaUpload:At}=wp.blockEditor;var Ut=t=>{let{update:n,add:o,remove:i,time:r,img:a,url:l}=t;const[c,s]=Mt(r),[d,u]=Mt(a);return(0,e.createElement)(Zt,{align:"center",direction:"column"},(0,e.createElement)(Zt,{align:"center"},(0,e.createElement)(Ot,null,(0,e.createElement)(It,{style:{width:"60px"},placeholder:"0",value:c,onChange:e=>s(e),onBlur:()=>{let e=(e=>{let t=e+"";return t?(t=t.replace(/[^\d]/g,""),t=parseInt(t),t):0})(c);n({time:e}),s(e)},autoComplete:"off"})),(0,e.createElement)(Dt,null,(0,e.createElement)(It,{placeholder:wp.i18n.__("Pause Prompt Link","mine-cloudvod"),value:l||"",onChange:e=>n({url:e}),autoComplete:"off"})),(0,e.createElement)(Ot,null,i&&(0,e.createElement)(Pt,{icon:"minus",style:{marginBottom:"8px"},label:wp.i18n.__("Remove Prompt","mine-cloudvod"),onClick:i}),o&&(0,e.createElement)(Pt,{icon:"plus-alt",label:wp.i18n.__("Add Prompt","mine-cloudvod"),style:{marginBottom:"8px"},onClick:()=>{o(),s(""),u("")}}))),(0,e.createElement)(Zt,{align:"center"},(0,e.createElement)(Dt,null,(0,e.createElement)(It,{placeholder:wp.i18n.__("Pause Prompt Image","mine-cloudvod"),value:d,onChange:e=>{u(e),n({img:e})},autoComplete:"off"})),(0,e.createElement)(Ot,null,(0,e.createElement)(At,{onSelect:e=>{let{url:t}=e;u(t),n({img:t})},allowedTypes:["image"],render:t=>{let{open:n}=t;return(0,e.createElement)(Pt,{icon:"format-image",label:wp.i18n.__("Select Image","mine-cloudvod"),style:{marginBottom:"8px"},onClick:()=>{n()}})}}))))};const{useState:Tt}=wp.element;var Ft=t=>{let{setAttributes:n,attributes:o}=t;const{pausePrompts:i}=o;let[r,a]=Tt({url:"",img:"",time:""});return(0,e.createElement)("div",null,(i||[]).sort((function(e,t){return parseInt(e.time)-parseInt(t.time)})).map(((t,o)=>(0,e.createElement)(Ut,{key:`${o}-${t.time}`,time:t.time,img:t.img,url:t.url,update:e=>{!function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=i.indexOf(e),r=i.map(((e,n)=>n!==o?e:{...e,...t}));n({pausePrompts:r})}(t,e)},remove:()=>{(e=>{let t=i.indexOf(e);n({pausePrompts:i.filter(((e,n)=>n!==t))})})(t)}}))),(0,e.createElement)(Ut,{time:r.time,img:r.img,url:r.url,update:e=>{a({...r,...e})},add:()=>{r.time&&r.img&&r.url&&(n({pausePrompts:[...i||[],{time:r.time,img:r.img,url:r.url}]}),a({url:"",img:"",time:""}))}}))};const{ToggleControl:Bt,PanelBody:Rt,TextControl:$t,Disabled:Nt}=wp.components,{useState:Lt}=wp.element;function Vt(t){let{price:n,preview:o,setAttributes:i}=t;const[r,a]=Lt(o>0);let l=!1;mcv_addons.actived&&mcv_addons.actived.filter((e=>"previewpurchase"==e.id)).length>0&&(l=!0);const c=(0,e.createElement)(e.Fragment,null,(0,e.createElement)($t,{type:"string",label:wp.i18n.__("Price","mine-cloudvod"),value:n,onChange:e=>i({price:e})}),(0,e.createElement)(Bt,{label:wp.i18n.__("Preview","mine-cloudvod"),onChange:()=>{r&&i({preview:0}),a(!r)},checked:r}),r&&(0,e.createElement)($t,{type:"number",label:wp.i18n.__("Preview Duration","mine-cloudvod"),value:o,onChange:e=>i({preview:parseInt(e)})}));return(0,e.createElement)(Rt,{title:wp.i18n.__("Price","mine-cloudvod"),initialOpen:n>0},!l&&(0,e.createElement)("p",null,(0,e.createElement)("a",{href:"admin.php?page=mcv-addons",style:{color:"orange",padding:"5px"}},wp.i18n.__("Please enable the Purchase Video Add-ons first.","mine-cloudvod"))),l?c:(0,e.createElement)(Nt,null,c))}const{Button:jt,Disabled:Gt,DropdownMenu:Kt,Spinner:qt,ToolbarGroup:zt,withNotices:Wt,Notice:Qt,BaseControl:Ht,Placeholder:Jt,ToggleControl:Xt,PanelBody:Yt,TextControl:en,DateTimePicker:tn,Flex:nn,FlexBlock:on,FlexItem:rn,ExternalLink:an}=wp.components,{BlockControls:ln,InspectorControls:cn,MediaUpload:sn,MediaUploadCheck:dn,useBlockProps:un}=wp.blockEditor,{useState:pn,Fragment:mn,useEffect:vn,useRef:fn}=wp.element,{dispatch:hn,useSelect:gn}=wp.data;var wn=Wt((t=>{let{attributes:n,setAttributes:i}=t;const{source:a,width:l,height:c,videoId:s,cover:d,autoplay:u,captions:p,slide:m,oss:v,live:_,countdown:f,slidetext:h,countdowntips:g,privt:w,price:y,preview:b}=n,[E,x]=pn(""),[k,C]=pn(""),[S,Z]=pn(""),O=e=>{mcv_nonce.endtime<Date.parse(new Date)/1e3?hn("mine-cloudvod/vod").setUI("proFeature",!0):Z(e)},[D,I]=pn(!1),[P,M]=pn(!!f),A=fn(),U=un({ref:A}),[T,F]=pn(mcv_alivod_config.sdk);vn((()=>{null==m&&i({slide:!!window.mcv_aliplayer_config.slide})}),[]);const B=e=>t=>{i({[e]:t})},R=e=>{wp.apiFetch({path:"mine-cloudvod/v1/aliyun/vod/update/cover",method:"POST",data:{cid:e,pid:parseInt(jQuery("#post_ID").val())}})};function $(e){console.log(e),i({cover:e.url}),R(e.id)}const N=(0,e.createElement)(mn,null,(0,e.createElement)(ln,null,(0,e.createElement)(St,{captions:p,onChange:e=>{i({captions:e})}}),(0,e.createElement)(zt,null,(0,e.createElement)(jt,{onClick:()=>{confirm(wp.i18n.__("Replace this "+(v.key?"OSS":"VoD")+" video?","mine-cloudvod"))&&(v.key?Z("oss"):Z("vod"),hn("mine-cloudvod/vod").setUI("pageNo",1),i({videoId:"",oss:"",source:""}))}},wp.i18n.__("Replace")))),(!!s||!!v||!!a)&&(0,e.createElement)(cn,null,(0,e.createElement)(Yt,{title:wp.i18n.__("Video Markers","mine-cloudvod"),initialOpen:!1},(0,e.createElement)(et,{setAttributes:i,attributes:n})),(0,e.createElement)(Vt,{price:y,preview:b,setAttributes:i}),(0,e.createElement)(Yt,{title:wp.i18n.__("Pause Prompt","mine-cloudvod"),initialOpen:!1},(0,e.createElement)(Ft,{setAttributes:i,attributes:n})),(0,e.createElement)(Yt,{title:wp.i18n.__("Aliplayer Settings","mine-cloudvod")},(0,e.createElement)(Xt,{label:wp.i18n.__("Private","mine-cloudvod"),onChange:B("privt"),checked:w}),w&&(0,e.createElement)("p",null,wp.i18n.__("This video is only accessible to those who are logged in.","mine-cloudvod")),(0,e.createElement)(Xt,{label:wp.i18n.__("Autoplay","mine-cloudvod"),onChange:B("autoplay"),checked:u}),!!a&&(0,e.createElement)(Xt,{label:wp.i18n.__("Live","mine-cloudvod"),onChange:B("live"),checked:_}),(0,e.createElement)(en,{type:"string",label:wp.i18n.__("Width"),value:void 0!==l?l:"",placeholder:"100%",onChange:e=>i({width:e})}),(0,e.createElement)(en,{type:"string",label:wp.i18n.__("Height"),value:void 0!==c?c:"",placeholder:"500px or auto",help:wp.i18n.__("The auto will be adaptive height.","mine-cloudvod"),onChange:e=>i({height:e})}),(0,e.createElement)(dn,null,(0,e.createElement)(Ht,{className:"editor-video-poster-control"},(0,e.createElement)(Ht.VisualLabel,null,(0,e.createElement)("p",null,wp.i18n.__("Cover image","mine-cloudvod"))),(0,e.createElement)("p",null,d?(0,e.createElement)("img",{src:d}):""),(0,e.createElement)(en,{type:"string",value:d,placeholder:"",onChange:e=>{$({url:e})}}),(0,e.createElement)(sn,{title:wp.i18n.__("Select cover image","mine-cloudvod"),onSelect:$,allowedTypes:["image"],render:t=>{let{open:n}=t;return(0,e.createElement)(jt,{isPrimary:!0,onClick:n},d?wp.i18n.__("Replace","mine-cloudvod"):wp.i18n.__("Select","mine-cloudvod"))}}),!!d&&(0,e.createElement)(jt,{onClick:function(){i({cover:""}),R(0)},isTertiary:!0},wp.i18n.__("Remove","mine-cloudvod"))))),(0,e.createElement)(Yt,{title:wp.i18n.__("Slide","mine-cloudvod"),initialOpen:!1},(0,e.createElement)(Xt,{label:wp.i18n.__("Enable","mine-cloudvod"),onChange:B("slide"),checked:m,help:wp.i18n.__("The global configuration is used by default and can be turned off individually.","mine-cloudvod")}),m&&(0,e.createElement)(en,{type:"string",label:wp.i18n.__("Scroll Text","mine-cloudvod"),value:void 0!==h?h:"",placeholder:wp.i18n.__("Empty means to use global configuration.","mine-cloudvod"),onChange:e=>i({slidetext:e}),help:wp.i18n.__("Can be dynamically replaced with these labels: {username} {userid} {userip} {useremail} {usernickname}","mine-cloudvod")})),(0,e.createElement)(Yt,{title:wp.i18n.__("Countdown Timer","mine-cloudvod"),initialOpen:!1},(0,e.createElement)(Xt,{label:wp.i18n.__("Enable","mine-cloudvod"),onChange:e=>M(e),checked:P}),P&&(0,e.createElement)(en,{type:"string",label:wp.i18n.__("Text","mine-cloudvod"),value:void 0!==g?g:"",onChange:e=>i({countdowntips:e}),help:wp.i18n.__("Enter the text you want to appear on the countdown page","mine-cloudvod")}),P&&(0,e.createElement)(tn,{currentDate:f,onChange:e=>i({countdown:e})}))));function L(){return wp.data.dispatch("core/editor").lockPostSaving("mine-aliplayer")}function V(){return wp.data.dispatch("core/editor").unlockPostSaving("mine-aliplayer")}return T?s||v.key||a?(D&&(0,e.createElement)(qt,null),(0,e.createElement)(mn,null,N,(0,e.createElement)("figure",o({className:"wp-block-video"},U),(0,e.createElement)(Gt,null,(0,e.createElement)(Ke,{attributes:n}))))):(0,e.createElement)("div",U,(0,e.createElement)(Jt,{label:wp.i18n.__("Alibaba Cloud","mine-cloudvod"),instructions:wp.i18n.__("Select a video source please.","mine-cloudvod"),icon:(0,e.createElement)("svg",{width:"28",height:"28",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg",fill:"none",className:"mine-block-icon"},(0,e.createElement)("path",{d:"M606.933 594.645a18.688 18.688 0 0 1-9.6-16.618V442.688c0-6.89 3.606-13.163 9.6-16.619 5.974-3.413 13.142-3.413 19.136 0l117.27 67.627c5.973 3.413 9.557 9.728 9.557 16.597a19.03 19.03 0 0 1-9.557 16.598l-117.27 67.754a19.541 19.541 0 0 1-19.136 0"}),(0,e.createElement)("path",{d:"M976.299 501.397a316.885 316.885 0 0 0-88.022-228.458 318.507 318.507 0 0 0-225.13-99.371c-111.211-2.773-214.998 51.968-275.968 145.579l-6.315 9.685-9.941-5.867a30.23 30.23 0 0 0-9.216-3.776 262.976 262.976 0 0 0-38.635-2.901c-142.87 0-259.093 116.224-259.093 259.05 0 142.849 116.224 259.073 259.093 259.073 92.928 0 176.853-48.512 223.424-127.872H461.44a190.293 190.293 0 0 1-138.155 59.2c-105.216 0-190.805-85.568-190.805-190.763s85.59-190.784 190.805-190.784c5.27 0 10.582 0.213 15.702 0.832l14.272 1.707-4.118 13.738a332.501 332.501 0 0 0-13.824 80.768l-0.17 12.822v85.226l89.45-90.24a229.675 229.675 0 0 1 71.339-162.304c44.715-42.773 103.381-65.28 165.184-64.106a229.44 229.44 0 0 1 162.005 71.338 229.824 229.824 0 0 1 64.15 165.184C884.587 621.696 784.34 721.835 662.4 725.205l-62.016 89.664 61.355-0.149c172.394-2.88 310.677-140.523 314.581-313.323"}))},(0,e.createElement)(mn,null,(0,e.createElement)(jt,{isPrimary:!0,onClick:()=>O("vod")},wp.i18n.__("Add/Select ","mine-cloudvod")+wp.i18n.__("ApsaraVideo VOD","mine-cloudvod")),(0,e.createElement)(jt,{isPrimary:!0,onClick:()=>O("oss")},wp.i18n.__("Add/Select ","mine-cloudvod")+wp.i18n.__("Aliyun OSS","mine-cloudvod")))),"vod"==S?(0,e.createElement)(Fe,{onClose:()=>Z(""),onChoose:function(e){i({videoId:e.videoId}),(0,r.gg)(e.duration),I(!0),L(),(async e=>{let{videoId:t,cover:n,title:o}=e;if(t){if(i({videoId:t,title:o}),mcv_alivod_config.down_snapshot){const e=await wp.apiFetch({path:"mine-cloudvod/v1/aliyun/vod/cover",method:"POST",data:{pid:parseInt(jQuery("#post_ID").val()),cover:n,title:o,vid:t}});e.src&&i({cover:e.src})}Z("")}else i({videoId:""})})({videoId:e.videoId,cover:e.thumbnail,title:e.title}).catch((e=>{i({videoId:""}),console.error(e)})).finally((()=>{V(),I(!1)}))}}):null,"oss"==S?(0,e.createElement)(Be.Z,{onClose:()=>Z(""),onChoose:function(e){I(!0),L(),(async e=>{let{key:t,bucket:n}=e;t?(i({oss:{key:t,bucket:n}}),Z("")):i({oss:""})})({key:e.key,bucket:e.bucket}).catch((e=>{i({oss:""}),console.error(e)})).finally((()=>{V(),I(!1)}))}}):null):(0,e.createElement)(Jt,{label:wp.i18n.__("Alibaba Cloud","mine-cloudvod"),instructions:wp.i18n.__("Please configure the Alibaba Cloud AccessKey first.","mine-cloudvod"),icon:(0,e.createElement)("svg",{width:"28",height:"28",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg",fill:"none",className:"mine-block-icon"},(0,e.createElement)("path",{d:"M606.933 594.645a18.688 18.688 0 0 1-9.6-16.618V442.688c0-6.89 3.606-13.163 9.6-16.619 5.974-3.413 13.142-3.413 19.136 0l117.27 67.627c5.973 3.413 9.557 9.728 9.557 16.597a19.03 19.03 0 0 1-9.557 16.598l-117.27 67.754a19.541 19.541 0 0 1-19.136 0"}),(0,e.createElement)("path",{d:"M976.299 501.397a316.885 316.885 0 0 0-88.022-228.458 318.507 318.507 0 0 0-225.13-99.371c-111.211-2.773-214.998 51.968-275.968 145.579l-6.315 9.685-9.941-5.867a30.23 30.23 0 0 0-9.216-3.776 262.976 262.976 0 0 0-38.635-2.901c-142.87 0-259.093 116.224-259.093 259.05 0 142.849 116.224 259.073 259.093 259.073 92.928 0 176.853-48.512 223.424-127.872H461.44a190.293 190.293 0 0 1-138.155 59.2c-105.216 0-190.805-85.568-190.805-190.763s85.59-190.784 190.805-190.784c5.27 0 10.582 0.213 15.702 0.832l14.272 1.707-4.118 13.738a332.501 332.501 0 0 0-13.824 80.768l-0.17 12.822v85.226l89.45-90.24a229.675 229.675 0 0 1 71.339-162.304c44.715-42.773 103.381-65.28 165.184-64.106a229.44 229.44 0 0 1 162.005 71.338 229.824 229.824 0 0 1 64.15 165.184C884.587 621.696 784.34 721.835 662.4 725.205l-62.016 89.664 61.355-0.149c172.394-2.88 310.677-140.523 314.581-313.323"}))},(0,e.createElement)(jt,{href:mcv_alivod_config.aliyun_config_url,target:"_self",isPrimary:!0},wp.i18n.__("Click here to configuration page","mine-cloudvod")))})),yn=window.wp.domReady,bn=__webpack_require__.n(yn),En=window.wp.components,xn=__webpack_require__(9818);function kn(){return(0,xn.useSelect)((e=>e("mine-cloudvod/vod").ui("proFeature")))?(0,e.createElement)(En.Modal,{title:wp.i18n.__("Pro Feature","mine-cloudvod"),onRequestClose:()=>{(0,xn.dispatch)("mine-cloudvod/vod").setUI("proFeature",!1)}},(0,e.createElement)("h2",null,wp.i18n.__("Unlock Mine CloudVoD","mine-cloudvod")),(0,e.createElement)("p",null,wp.i18n.__("Get this feature and more with the Pro version of Mine CloudVod!","mine-cloudvod")),(0,e.createElement)(En.Button,{href:mcv_nonce.buynow,target:"_blank",isPrimary:!0},wp.i18n.__("Buy Now","mine-cloudvod")),(0,e.createElement)(En.Button,{href:"https://www.zwtt8.com/docs-category/mine-cloudvod/",target:"_blank"},wp.i18n.__("Learn More","mine-cloudvod"))):""}bn()((function(){if(!document.getElementById("mcv-plugin-app")){let t=document.createElement("div");t.setAttribute("id","mcv-plugin-app"),document.querySelector("body").append(t),window.appRoot=(0,e.createRoot)(document.getElementById("mcv-plugin-app"))}e.createRoot?window.appRoot.render((0,e.createElement)(kn,null)):(0,e.render)((0,e.createElement)(kn,null),document.getElementById("mcv-plugin-app"))}));const Cn={icon:(0,e.createElement)("svg",{width:"28",height:"28",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg",fill:"none",className:"mine-block-icon"},(0,e.createElement)("path",{d:"M606.933 594.645a18.688 18.688 0 0 1-9.6-16.618V442.688c0-6.89 3.606-13.163 9.6-16.619 5.974-3.413 13.142-3.413 19.136 0l117.27 67.627c5.973 3.413 9.557 9.728 9.557 16.597a19.03 19.03 0 0 1-9.557 16.598l-117.27 67.754a19.541 19.541 0 0 1-19.136 0"}),(0,e.createElement)("path",{d:"M976.299 501.397a316.885 316.885 0 0 0-88.022-228.458 318.507 318.507 0 0 0-225.13-99.371c-111.211-2.773-214.998 51.968-275.968 145.579l-6.315 9.685-9.941-5.867a30.23 30.23 0 0 0-9.216-3.776 262.976 262.976 0 0 0-38.635-2.901c-142.87 0-259.093 116.224-259.093 259.05 0 142.849 116.224 259.073 259.093 259.073 92.928 0 176.853-48.512 223.424-127.872H461.44a190.293 190.293 0 0 1-138.155 59.2c-105.216 0-190.805-85.568-190.805-190.763s85.59-190.784 190.805-190.784c5.27 0 10.582 0.213 15.702 0.832l14.272 1.707-4.118 13.738a332.501 332.501 0 0 0-13.824 80.768l-0.17 12.822v85.226l89.45-90.24a229.675 229.675 0 0 1 71.339-162.304c44.715-42.773 103.381-65.28 165.184-64.106a229.44 229.44 0 0 1 162.005 71.338 229.824 229.824 0 0 1 64.15 165.184C884.587 621.696 784.34 721.835 662.4 725.205l-62.016 89.664 61.355-0.149c172.394-2.88 310.677-140.523 314.581-313.323"})),edit:wn,save:function(){return null}};(0,t.registerBlockType)(n.u2,Cn)}()})();